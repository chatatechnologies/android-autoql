<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Barchart demo</title>
    <script src="https://d3js.org/d3.v4.min.js"></script>
</head>
<style>
  body {
    background: #3b3f46 !important;
  }
</style>
<body>
  <script>
var data = [
  {name: 'date1', value: 100},
  {name: 'date2', value: -100},
  {name: 'date3', value: -150},
  {name: 'date4', value: 55},
  {name: 'date5', value: 150},
  {name: 'date6', value: 120},
  {name: 'date7', value: 450},
  {name: 'date8', value: 980},
  {name: 'date9', value: 1200},
]

var leftMargin = 50;  // Space to the left of first bar; accomodates y-axis labels
var rightMargin = 10; // Space to the right of last bar
var margin = {left: leftMargin, right: rightMargin, top: 10, bottom: 10};
var barWidth = 90;  // Width of the bars
var chartHeight = 470 - margin.top - margin.bottom;  // Height of chart, from x-axis (ie. y=0)
var chartWidth = data.length * barWidth;

var min = Math.min(...data.map(item => item.value) );
var max = Math.max(...data.map(item => item.value) );

var y0 = Math.max(Math.abs(min), Math.abs(max));

var xScale = d3.scaleBand()
  .range([0, chartWidth])
  .domain(data.map(function(d) { return d.name; }))
  .padding(0.05);

/* This scale produces negative output for negatve input */
var yScale = d3.scaleLinear()
  .domain([-y0, y0])
  .range([chartHeight, 0]);

var svg = d3.select('body').append('svg')
  .attr('height', chartHeight + margin.top + margin.bottom)
  .attr('width', chartWidth + margin.left + margin.right)
  .append('g')
  .attr('transform', function(d) {
    return `translate(${margin.left}, ${margin.top})`;
  })
svg.style('border', '1px solid');

var colorBi = ['#26a7e9'];
var scaleColorBi = d3.scaleOrdinal().range(colorBi);

svg
  .selectAll("rect")
  .data(data)
  .enter()
  .append("rect")
    .attr("x", function(d) { return xScale(d.name); })
    .attr("width", xScale.bandwidth())
    //if Math.max is 0, the bar is negative orientation
    .attr('y', function(d) {
      var factor;
      if (yScale(d.value) > chartHeight / 2) {
        factor = chartHeight / 2;
      } else {
        factor = yScale( d.value)
      }
      return factor;
    })
    //absolute value for column
    .attr('height', function(d) {
      return Math.abs(yScale(d.value) - yScale(0));
    })
    .style('fill', function(d) {
			return scaleColorBi(d.value);
		})
    .style('stroke', 'white')
    .style('stroke-width', '0');

var yAxis = d3.axisLeft(yScale);

svg.append('g')
  .attr('transform', function(d) {
    return `translate(0, 0)`;
  })
  .call(yAxis);
  </script>
</body>
</html>