<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1.0, user-scalable=no">
<script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
<script src="https://d3js.org/d3.v6.min.js"></script>
<title></title>
<style>
	* {
    margin: 0;
    padding: 0;
  }
  body {
    border: none;
  }
  body, table, th {
		background: #3b3f46!important;
		color: #ffffff!important;
  }
  table {
    padding-top: 0px!important;
  }
  th {
    position: sticky;
    top: 0px;
    z-index: 10;
    padding: 10px 3px 5px 3px;
  }
  table {
    font-size: 16px;
    display: table;
    min-width: 100%;
    white-space: nowrap;
    border-collapse: separate;
    border-spacing: 0px!important;
    border-color: grey;
  }
  tr td:first-child {
    text-align: center;
  }
  td {
    padding: 3px;
    text-align: center!important;
  }
  td, th {
    font-size: 16px;
    max-width: 200px;
    white-space: nowrap;
    width: 50px;
    overflow: hidden;
    text-overflow: ellipsis;
    border: 0.5px solid #cccccc;
  }
  /*border for svg*/
  svg {
    border: none;
  }
  tfoot {
    /*display: table-header-group;*/
    display: none;
  }
	.empty-state {
    text-align: center;
    font-family: '-apple-system','HelveticaNeue';
    color: #ffffff!important;
  }
  .button {
    border: none;
    color: white;
    padding: 15px 32px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
  }
</style>
</head>
<body>
<table id="idTableBasic"><thead><tr><th>Invoice Number</th><th>Batch</th><th>Customer</th><th>Invoice Date</th><th>Invoice Amount</th><th>Invoice Status</th><th>Term</th><th>Discount Date</th><th>Tax</th><th>Due Date</th><th>Discount Percent</th><th>Job</th><th>Job Type</th><th>Area</th><th>Province</th></tr></thead><tfoot><tr><th>Invoice Number</th><th>Batch</th><th>Customer</th><th>Invoice Date</th><th>Invoice Amount</th><th>Invoice Status</th><th>Term</th><th>Discount Date</th><th>Tax</th><th>Due Date</th><th>Discount Percent</th><th>Job</th><th>Job Type</th><th>Area</th><th>Province</th></tr></tfoot><tbody><tr><td>INV00000059</td><td>AR00000038</td><td>Shell</td><td>Nov 6, 2019</td><td>$2,200.00</td><td>2</td><td>Due in 30 days.</td><td>Nov 6, 2019</td><td>$0.00</td><td>Dec 6, 2019</td><td>0</td><td>J00000907</td><td>Hydrovac</td><td>Texas</td><td>Texas</td></tr><tr><td>INV00000058</td><td>AR00000037</td><td>Advantage Oil</td><td>Oct 18, 2019</td><td>$525.00</td><td>2</td><td>Due in 30 days.</td><td>Oct 18, 2019</td><td>$25.00</td><td>Nov 17, 2019</td><td>0</td><td>J00005642</td><td>Truck Hauling</td><td>Texas</td><td>Alberta</td></tr><tr><td>INV00000057</td><td>AR00000036</td><td>Rice Energy</td><td>Sep 1, 2019</td><td>$682.50</td><td>2</td><td>Due in 30 days.</td><td>Sep 1, 2019</td><td>$32.50</td><td>Oct 1, 2019</td><td>0</td><td>J00003053</td><td>Hydrovac</td><td>Midland, TX</td><td></td></tr><tr><td>INV00000056</td><td>AR00000035</td><td>Bill & Sons</td><td>Feb 23, 2018</td><td>$5,250.00</td><td>2</td><td>Due in 30 days.</td><td>Feb 23, 2018</td><td>$250.00</td><td>Mar 25, 2018</td><td>0</td><td>J00004246</td><td>Well Servicing</td><td>Northern Alberta</td><td></td></tr><tr><td>INV00000055</td><td>AR00000034</td><td>Shell</td><td>Dec 13, 2017</td><td>$7,896.00</td><td>2</td><td>Due in 30 days.</td><td>Dec 13, 2017</td><td>$376.00</td><td>Jan 12, 2018</td><td>0</td><td>J00003178</td><td>Hydrovac</td><td>Texas</td><td></td></tr><tr><td>INV00000052</td><td>AR00000032</td><td>Petronix Inc.</td><td>Dec 12, 2017</td><td>$2,310.00</td><td>2</td><td>Due in 30 days.</td><td>Dec 12, 2017</td><td>$110.00</td><td>Jan 11, 2018</td><td>0</td><td>J00002810</td><td>Hydrovac</td><td>Southern Alberta</td><td>Alberta</td></tr><tr><td>INV00000051</td><td>AR00000032</td><td>Chesapeake Energy</td><td>Dec 12, 2017</td><td>$236.25</td><td>2</td><td>Due in 30 days.</td><td>Dec 12, 2017</td><td>$11.25</td><td>Jan 11, 2018</td><td>0</td><td>J00002831</td><td>Hydrovac</td><td>Northern BC</td><td></td></tr><tr><td>INV00000050</td><td>AR00000031</td><td>Marshall Fluid Hauling Services</td><td>Dec 5, 2017</td><td>$110.25</td><td>2</td><td>Due in 30 days.</td><td>Dec 5, 2017</td><td>$5.25</td><td>Jan 4, 2018</td><td>0</td><td>J00000992</td><td>Fluid Hauling</td><td>Midland, TX</td><td>Texas</td></tr><tr><td>INV00000050</td><td>AR00000031</td><td>Marshall Fluid Hauling Services</td><td>Dec 5, 2017</td><td>$110.25</td><td>2</td><td>Due in 30 days.</td><td>Dec 5, 2017</td><td>$5.25</td><td>Jan 4, 2018</td><td>0</td><td>J00000992</td><td>Fluid Hauling</td><td>Midland, TX</td><td>Texas</td></tr><tr><td>INV00000048</td><td>AR00000029</td><td>Marshall Fluid Hauling Services</td><td>Dec 4, 2017</td><td>$175.87</td><td>2</td><td>Due in 30 days.</td><td>Dec 4, 2017</td><td>$8.37</td><td>Jan 3, 2018</td><td>0</td><td>J00000992</td><td>Fluid Hauling</td><td>Midland, TX</td><td>Texas</td></tr><tr><td>INV00000048</td><td>AR00000029</td><td>Marshall Fluid Hauling Services</td><td>Dec 4, 2017</td><td>$175.87</td><td>2</td><td>Due in 30 days.</td><td>Dec 4, 2017</td><td>$8.37</td><td>Jan 3, 2018</td><td>0</td><td>J00000992</td><td>Fluid Hauling</td><td>Midland, TX</td><td>Texas</td></tr><tr><td>INV00000049</td><td>AR00000030</td><td>Marshall Fluid Hauling Services</td><td>Dec 4, 2017</td><td>$168.00</td><td>3</td><td>Due in 30 days.</td><td>Dec 4, 2017</td><td>$8.00</td><td>Jan 3, 2018</td><td>0</td><td>J00000992</td><td>Fluid Hauling</td><td>Midland, TX</td><td>Texas</td></tr><tr><td>INV00000049</td><td>AR00000030</td><td>Marshall Fluid Hauling Services</td><td>Dec 4, 2017</td><td>$168.00</td><td>3</td><td>Due in 30 days.</td><td>Dec 4, 2017</td><td>$8.00</td><td>Jan 3, 2018</td><td>0</td><td>J00000992</td><td>Fluid Hauling</td><td>Midland, TX</td><td>Texas</td></tr><tr><td>INV00000047</td><td>AR00000028</td><td>American Business Corporation</td><td>Nov 15, 2017</td><td>$1,449.00</td><td>2</td><td>Due in 30 days.</td><td>Nov 15, 2017</td><td>$69.00</td><td>Dec 15, 2017</td><td>0</td><td>J00003283</td><td>Hydrovac</td><td>ABC Truckline</td><td></td></tr><tr><td>INV00000046</td><td>AR00000028</td><td>American Business Corporation</td><td>Nov 15, 2017</td><td>$1,876.87</td><td>2</td><td>Due in 30 days.</td><td>Nov 15, 2017</td><td>$89.37</td><td>Dec 15, 2017</td><td>0</td><td>J00003283</td><td>Hydrovac</td><td>ABC Truckline</td><td></td></tr><tr><td>INV00000045</td><td>AR00000027</td><td>Clark Resources</td><td>Mar 23, 2017</td><td>$252.00</td><td>3</td><td>Due in 30 days.</td><td>Mar 23, 2017</td><td>$12.00</td><td>Apr 22, 2017</td><td>0</td><td>J00001077</td><td>Fluid Hauling</td><td>Midland, TX</td><td>Texas</td></tr><tr><td>INV00000041</td><td>AR00000025</td><td>Canadian Business Corporation</td><td>Mar 22, 2017</td><td>$1,890.00</td><td>2</td><td>Due in 30 days.</td><td>Mar 22, 2017</td><td>$90.00</td><td>Apr 21, 2017</td><td>0</td><td>J00002177</td><td>Hydrovac</td><td>Southern Alberta</td><td>Alberta</td></tr><tr><td>INV00000040</td><td>AR00000025</td><td>Southern Trucking and Services</td><td>Mar 22, 2017</td><td>$4,488.75</td><td>2</td><td>Due in 30 days.</td><td>Mar 22, 2017</td><td>$213.75</td><td>Apr 21, 2017</td><td>0</td><td>J00002176</td><td>Hydrovac</td><td>Southern Alberta</td><td>Alberta</td></tr><tr><td>INV00000044</td><td>AR00000026</td><td>Southern Trucking and Services</td><td>Mar 22, 2017</td><td>$1,107.75</td><td>2</td><td>Due in 30 days.</td><td>Mar 22, 2017</td><td>$52.75</td><td>Apr 21, 2017</td><td>0</td><td>J00001078</td><td>Hydrovac</td><td>Louisiana</td><td>Alberta</td></tr><tr><td>INV00000043</td><td>AR00000025</td><td>Sirocco Enterprises</td><td>Mar 22, 2017</td><td>$1,338.75</td><td>2</td><td>Due in 30 days.</td><td>Mar 22, 2017</td><td>$63.75</td><td>Apr 21, 2017</td><td>0</td><td>J00002178</td><td>Hydrovac</td><td>Southern Alberta</td><td>Alberta</td></tr><tr><td>INV00000042</td><td>AR00000025</td><td>Southern Trucking and Services</td><td>Mar 22, 2017</td><td>$6,200.25</td><td>2</td><td>Due in 30 days.</td><td>Mar 22, 2017</td><td>$295.25</td><td>Apr 21, 2017</td><td>0</td><td>J00002175</td><td>Hydrovac</td><td>Southern Alberta</td><td>Alberta</td></tr><tr><td>INV00000042</td><td>AR00000025</td><td>Southern Trucking and Services</td><td>Mar 22, 2017</td><td>$6,200.25</td><td>2</td><td>Due in 30 days.</td><td>Mar 22, 2017</td><td>$295.25</td><td>Apr 21, 2017</td><td>0</td><td>J00002174</td><td>Hydrovac</td><td>Southern Alberta</td><td>Alberta</td></tr><tr><td>INV00000039</td><td>AR00000024</td><td>Great Big North</td><td>Mar 21, 2017</td><td>$307.12</td><td>3</td><td>Due in 30 days.</td><td>Mar 21, 2017</td><td>$14.62</td><td>Apr 20, 2017</td><td>0</td><td>J00002164</td><td>Fluid Hauling</td><td>Texas</td><td>Oklahoma</td></tr><tr><td>INV00000036</td><td>AR00000021</td><td>Petronix Inc.</td><td>Feb 27, 2017</td><td>$-10,500.00</td><td>2</td><td>Due in 30 days.</td><td>Feb 27, 2017</td><td>$-500.00</td><td>Mar 29, 2017</td><td>0</td><td>J00000496</td><td>Well Servicing</td><td>Texas</td><td></td></tr><tr><td>INV00000035</td><td>AR00000020</td><td>Clark Resources</td><td>Feb 27, 2017</td><td>$-315.00</td><td>2</td><td>Due in 30 days.</td><td>Feb 27, 2017</td><td>$-15.00</td><td>Mar 29, 2017</td><td>0</td><td>J00001077</td><td>Fluid Hauling</td><td>Midland, TX</td><td>Texas</td></tr><tr><td>INV00000034</td><td>AR00000019</td><td>Clark Resources</td><td>Feb 27, 2017</td><td>$-351.75</td><td>2</td><td>Due in 30 days.</td><td>Feb 27, 2017</td><td>$-16.75</td><td>Mar 29, 2017</td><td>0</td><td>J00001077</td><td>Fluid Hauling</td><td>Midland, TX</td><td>Texas</td></tr><tr><td>INV00000037</td><td>AR00000022</td><td>Clark Resources</td><td>Feb 26, 2017</td><td>$-677.25</td><td>2</td><td>Due in 30 days.</td><td>Feb 26, 2017</td><td>$-32.25</td><td>Mar 28, 2017</td><td>0</td><td>J00001077</td><td>Fluid Hauling</td><td>Midland, TX</td><td>Texas</td></tr><tr><td>INV00000029</td><td>AR00000014</td><td>Clark Resources</td><td>Feb 6, 2017</td><td>$593.25</td><td>2</td><td>Due in 30 days.</td><td>Feb 6, 2017</td><td>$28.25</td><td>Mar 8, 2017</td><td>0</td><td>J00001077</td><td>Fluid Hauling</td><td>Midland, TX</td><td>Texas</td></tr><tr><td>INV00000028</td><td>AR00000013</td><td>Southern Trucking and Services</td><td>Feb 6, 2017</td><td>$966.00</td><td>2</td><td>Due in 30 days.</td><td>Feb 6, 2017</td><td>$46.00</td><td>Mar 8, 2017</td><td>0</td><td>J00001078</td><td>Hydrovac</td><td>Louisiana</td><td>Alberta</td></tr><tr><td>INV00000026</td><td>AR00000011</td><td>Canadian Business Corporation</td><td>Feb 6, 2017</td><td>$1,060.50</td><td>2</td><td>Due in 30 days.</td><td>Feb 6, 2017</td><td>$50.50</td><td>Mar 8, 2017</td><td>0</td><td>J00001074</td><td>Fluid Hauling</td><td>Louisiana</td><td>Louisiana</td></tr><tr><td>INV00000038</td><td>AR00000023</td><td>Southern Trucking and Services</td><td>Feb 5, 2017</td><td>$-1,107.75</td><td>2</td><td>Due in 30 days.</td><td>Feb 5, 2017</td><td>$-52.75</td><td>Mar 7, 2017</td><td>0</td><td>J00001078</td><td>Hydrovac</td><td>Louisiana</td><td>Alberta</td></tr><tr><td>INV00000025</td><td>AR00000010</td><td>Bill & Sons</td><td>Jan 13, 2017</td><td>$2,992.50</td><td>2</td><td>Due in 30 days.</td><td>Jan 13, 2017</td><td>$142.50</td><td>Feb 12, 2017</td><td>0</td><td>J00000003</td><td>Hydrovac</td><td>Southern Alberta</td><td>Alberta</td></tr><tr><td>INV00000023</td><td>AR00000009</td><td>Bill & Sons</td><td>Jan 13, 2017</td><td>$2,992.50</td><td>4</td><td>Due in 30 days.</td><td>Jan 13, 2017</td><td>$142.50</td><td>Feb 12, 2017</td><td>0</td><td>J00000003</td><td>Hydrovac</td><td>Southern Alberta</td><td>Alberta</td></tr><tr><td>INV00000022</td><td>AR00000009</td><td>Bill & Sons</td><td>Jan 13, 2017</td><td>$7,403.28</td><td>4</td><td>Due in 30 days.</td><td>Jan 13, 2017</td><td>$352.53</td><td>Feb 12, 2017</td><td>0</td><td>J00000765</td><td>Hydrovac</td><td>Northern Alberta</td><td></td></tr><tr><td>INV00000022</td><td>AR00000009</td><td>Bill & Sons</td><td>Jan 13, 2017</td><td>$7,403.28</td><td>4</td><td>Due in 30 days.</td><td>Jan 13, 2017</td><td>$352.53</td><td>Feb 12, 2017</td><td>0</td><td>J00000005</td><td>Hydrovac</td><td>Northern Alberta</td><td>Alberta</td></tr><tr><td>INV00000024</td><td>AR00000010</td><td>Bill & Sons</td><td>Jan 13, 2017</td><td>$7,403.28</td><td>2</td><td>Due in 30 days.</td><td>Jan 13, 2017</td><td>$352.53</td><td>Feb 12, 2017</td><td>0</td><td>J00000765</td><td>Hydrovac</td><td>Northern Alberta</td><td></td></tr><tr><td>INV00000024</td><td>AR00000010</td><td>Bill & Sons</td><td>Jan 13, 2017</td><td>$7,403.28</td><td>2</td><td>Due in 30 days.</td><td>Jan 13, 2017</td><td>$352.53</td><td>Feb 12, 2017</td><td>0</td><td>J00000005</td><td>Hydrovac</td><td>Northern Alberta</td><td>Alberta</td></tr><tr><td>INV00000021</td><td>AR00000008</td><td>Great Big North</td><td>Dec 11, 2016</td><td>$2,835.00</td><td>2</td><td>Due on receipt</td><td>Dec 11, 2016</td><td>$135.00</td><td>Dec 11, 2016</td><td>0</td><td>J00000499</td><td>Well Servicing</td><td>Louisiana</td><td>New Mexico</td></tr><tr><td>INV00000021</td><td>AR00000008</td><td>Great Big North</td><td>Dec 11, 2016</td><td>$2,835.00</td><td>2</td><td>Due on receipt</td><td>Dec 11, 2016</td><td>$135.00</td><td>Dec 11, 2016</td><td>0</td><td>J00000499</td><td>Well Servicing</td><td>Louisiana</td><td>New Mexico</td></tr><tr><td>INV00000033</td><td>AR00000018</td><td>Sirocco Enterprises</td><td>Nov 6, 2016</td><td>$-5,213.25</td><td>2</td><td>Due in 30 days.</td><td>Nov 6, 2016</td><td>$-248.25</td><td>Dec 6, 2016</td><td>0</td><td>J00000001</td><td>Hydrovac</td><td>Southern Alberta</td><td>Alberta</td></tr><tr><td>INV00000032</td><td>AR00000017</td><td>Bill & Sons</td><td>Nov 6, 2016</td><td>$-2,992.50</td><td>2</td><td>Due in 30 days.</td><td>Nov 6, 2016</td><td>$-142.50</td><td>Dec 6, 2016</td><td>0</td><td>J00000003</td><td>Hydrovac</td><td>Southern Alberta</td><td>Alberta</td></tr><tr><td>INV00000031</td><td>AR00000016</td><td>Great Big North</td><td>Aug 14, 2016</td><td>$-798.00</td><td>2</td><td>Due in 30 days.</td><td>Aug 14, 2016</td><td>$-38.00</td><td>Sep 13, 2016</td><td>0</td><td>J00000004</td><td>Hydrovac</td><td>Northern Alberta</td><td>Alberta</td></tr><tr><td>INV00000030</td><td>AR00000015</td><td>Great Big North</td><td>Jul 31, 2016</td><td>$-1,890.00</td><td>2</td><td>Due in 30 days.</td><td>Jul 31, 2016</td><td>$-90.00</td><td>Aug 30, 2016</td><td>0</td><td>J00000004</td><td>Hydrovac</td><td>Northern Alberta</td><td>Alberta</td></tr><tr><td>INV00000020</td><td>AR00000007</td><td>Marshall Fluid Hauling Services</td><td>Jul 24, 2016</td><td>$957.60</td><td>2</td><td>Due in 30 days.</td><td>Jun 18, 2016</td><td>$45.60</td><td>Jul 18, 2016</td><td>0</td><td>J00000007</td><td>Hydrovac</td><td>Central Saskatchewan</td><td>Saskatchewan</td></tr><tr><td>INV00000019</td><td>AR00000007</td><td>Marshall Fluid Hauling Services</td><td>Jul 24, 2016</td><td>$1,244.25</td><td>2</td><td>Due in 30 days.</td><td>Jun 18, 2016</td><td>$59.25</td><td>Jul 18, 2016</td><td>0</td><td>J00000007</td><td>Hydrovac</td><td>Central Saskatchewan</td><td>Saskatchewan</td></tr><tr><td>INV00000018</td><td>AR00000007</td><td>Clark Resources</td><td>Jul 24, 2016</td><td>$2,226.00</td><td>2</td><td>Due in 30 days.</td><td>Jun 18, 2016</td><td>$106.00</td><td>Jul 18, 2016</td><td>0</td><td>J00000006</td><td>Hydrovac</td><td>Northern Alberta</td><td>Alberta</td></tr><tr><td>INV00000017</td><td>AR00000007</td><td>Bill & Sons</td><td>Jul 24, 2016</td><td>$2,756.25</td><td>2</td><td>Due in 30 days.</td><td>Jun 18, 2016</td><td>$131.25</td><td>Jul 18, 2016</td><td>0</td><td>J00000003</td><td>Hydrovac</td><td>Southern Alberta</td><td>Alberta</td></tr><tr><td>INV00000016</td><td>AR00000007</td><td>Petronix Inc.</td><td>Jul 24, 2016</td><td>$6,258.00</td><td>2</td><td>Due in 30 days.</td><td>Jun 18, 2016</td><td>$298.00</td><td>Jul 18, 2016</td><td>0</td><td>J00000002</td><td>Hydrovac</td><td>Southern Alberta</td><td>Alberta</td></tr><tr><td>INV00000015</td><td>AR00000007</td><td>Petronix Inc.</td><td>Jul 24, 2016</td><td>$6,258.00</td><td>2</td><td>Due in 30 days.</td><td>Jun 18, 2016</td><td>$298.00</td><td>Jul 18, 2016</td><td>0</td><td>J00000002</td><td>Hydrovac</td><td>Southern Alberta</td><td>Alberta</td></tr><tr><td>INV00000014</td><td>AR00000007</td><td>Petronix Inc.</td><td>Jul 24, 2016</td><td>$4,168.50</td><td>2</td><td>Due in 30 days.</td><td>Jun 18, 2016</td><td>$198.50</td><td>Jul 18, 2016</td><td>0</td><td>J00000002</td><td>Hydrovac</td><td>Southern Alberta</td><td>Alberta</td></tr><tr><td>INV00000013</td><td>AR00000006</td><td>Petronix Inc.</td><td>Jul 14, 2016</td><td>$1,220.62</td><td>2</td><td>Due in 30 days.</td><td>Jul 14, 2016</td><td>$58.12</td><td>Aug 13, 2016</td><td>0</td><td>J00000008</td><td>Hydrovac</td><td>Central Saskatchewan</td><td>Alberta</td></tr><tr><td>INV00000012</td><td>AR00000006</td><td>Petronix Inc.</td><td>Jul 14, 2016</td><td>$2,493.75</td><td>2</td><td>Due in 30 days.</td><td>Jul 14, 2016</td><td>$118.75</td><td>Aug 13, 2016</td><td>0</td><td>J00000008</td><td>Hydrovac</td><td>Central Saskatchewan</td><td>Alberta</td></tr><tr><td>INV00000011</td><td>AR00000006</td><td>Petronix Inc.</td><td>Jul 14, 2016</td><td>$577.50</td><td>2</td><td>Due in 30 days.</td><td>Jul 14, 2016</td><td>$27.50</td><td>Aug 13, 2016</td><td>0</td><td>J00000008</td><td>Hydrovac</td><td>Central Saskatchewan</td><td>Alberta</td></tr><tr><td>INV00000010</td><td>AR00000006</td><td>Bill & Sons</td><td>Jul 14, 2016</td><td>$3,150.00</td><td>2</td><td>Due in 30 days.</td><td>Jul 14, 2016</td><td>$150.00</td><td>Aug 13, 2016</td><td>0</td><td>J00000003</td><td>Hydrovac</td><td>Southern Alberta</td><td>Alberta</td></tr><tr><td>INV00000009</td><td>AR00000006</td><td>Bill & Sons</td><td>Jul 14, 2016</td><td>$3,150.00</td><td>2</td><td>Due in 30 days.</td><td>Jul 14, 2016</td><td>$150.00</td><td>Aug 13, 2016</td><td>0</td><td>J00000003</td><td>Hydrovac</td><td>Southern Alberta</td><td>Alberta</td></tr><tr><td>INV00000008</td><td>AR00000005</td><td>Great Big North</td><td>Jul 10, 2016</td><td>$2,688.00</td><td>2</td><td>Due in 30 days.</td><td>Jul 10, 2016</td><td>$128.00</td><td>Aug 9, 2016</td><td>0</td><td>J00000004</td><td>Hydrovac</td><td>Northern Alberta</td><td>Alberta</td></tr><tr><td>INV00000007</td><td>AR00000005</td><td>Great Big North</td><td>Jul 10, 2016</td><td>$2,688.00</td><td>2</td><td>Due in 30 days.</td><td>Jul 10, 2016</td><td>$128.00</td><td>Aug 9, 2016</td><td>0</td><td>J00000004</td><td>Hydrovac</td><td>Northern Alberta</td><td>Alberta</td></tr><tr><td>INV00000006</td><td>AR00000005</td><td>Great Big North</td><td>Jul 10, 2016</td><td>$2,688.00</td><td>2</td><td>Due in 30 days.</td><td>Jul 10, 2016</td><td>$128.00</td><td>Aug 9, 2016</td><td>0</td><td>J00000004</td><td>Hydrovac</td><td>Northern Alberta</td><td>Alberta</td></tr><tr><td>INV00000005</td><td>AR00000004</td><td>Bill & Sons</td><td>Jul 10, 2016</td><td>$1,905.75</td><td>2</td><td>Due in 30 days.</td><td>Jul 10, 2016</td><td>$90.75</td><td>Aug 9, 2016</td><td>0</td><td>J00000005</td><td>Hydrovac</td><td>Northern Alberta</td><td>Alberta</td></tr><tr><td>INV00000004</td><td>AR00000004</td><td>Bill & Sons</td><td>Jul 10, 2016</td><td>$2,173.50</td><td>2</td><td>Due in 30 days.</td><td>Jul 10, 2016</td><td>$103.50</td><td>Aug 9, 2016</td><td>0</td><td>J00000005</td><td>Hydrovac</td><td>Northern Alberta</td><td>Alberta</td></tr><tr><td>INV00000003</td><td>AR00000003</td><td>Bill & Sons</td><td>Jul 10, 2016</td><td>$3,150.00</td><td>2</td><td>Due in 30 days.</td><td>Jul 10, 2016</td><td>$150.00</td><td>Aug 9, 2016</td><td>0</td><td>J00000003</td><td>Hydrovac</td><td>Southern Alberta</td><td>Alberta</td></tr><tr><td>INV00000002</td><td>AR00000002</td><td>Sirocco Enterprises</td><td>Jun 7, 2016</td><td>$4,389.00</td><td>4</td><td>Due in 30 days.</td><td>Jun 7, 2016</td><td>$209.00</td><td>Jul 7, 2016</td><td>0</td><td>J00000001</td><td>Hydrovac</td><td>Southern Alberta</td><td>Alberta</td></tr><tr><td>INV00000001</td><td>AR00000001</td><td>Sirocco Enterprises</td><td>Jun 7, 2016</td><td>$5,213.25</td><td>2</td><td>Due in 30 days.</td><td>Jun 7, 2016</td><td>$248.25</td><td>Jul 7, 2016</td><td>0</td><td>J00000001</td><td>Hydrovac</td><td>Southern Alberta</td><td>Alberta</td></tr></tbody></table>

<script>
function getFirst10(string) {
  var newString = '';
  if (string.length < 11) {
    newString = string;
  } else {
    newString = string.substring(0, 10) + '...';
  }
  return newString;
}

function digitsCount(n) {
	var count = 0;
	if ( n >= 1) ++count;

	while (n/ 10 >= 1) {
		n /= 10;
		++count;
	}
	return count;
}

function angle(d) {
	var a = (d.startAngle + d.endAngle) * 90 / Math.PI - 90;
	return a > 90 ? a - 180 : a;
}

function isHorizontal() {
  return typeChart == TypeEnum.BAR;
}

function clearSvg() {
	//remove svg
	d3.select('svg').remove();
}

function updateSize() {
	var _bottom = (isHorizontal() ? _maxValue : limitName) + marginAxis;
	var _left = (isHorizontal() ? limitName : _maxValue) + marginAxis;

	margin.left = _left;
	margin.bottom = _bottom;

  var height1 = $(window).height() - margin.top - margin.bottom;
  var width1 = getWidthMargin();

  if (typeChart === TypeEnum.LINE) {
    if (nColumns === 2) {
      var width1 = getWidthMargin();
      width = (width1 * 2.5);
      height = height1;
    } else {
      width = getWidthMargin();
      height = height1;
    }
  } else {
    switch (typeChart) {
      case TypeEnum.BAR:
        width = width1 * 2;
        if (nColumns == 2) {
          height = (height1 * 2.5);
        } else {
          height = height1;
        }
        break;
      case TypeEnum.COLUMN:
        if (nColumns == 2) {
          width = (width1 * 2.5);
        } else {
          width = width1;
        }
        height = height1;
        break;
      case TypeEnum.PIE:
      default:
        width = getWidthMargin();
        height = height1;
        break;
    }
  }
  radius = Math.min(width, height) / 2;
}

function getWidthMargin() {
  return $(window).width() - margin.left - margin.right;
}

function isMultiple(typeChart) {
  return nColumns > 3 && (typeChart == TypeEnum.BAR || typeChart == TypeEnum.COLUMN || typeChart == TypeEnum.LINE);
}

function updateData(tmpChart, isReload) {
	//console.log("height " + $(window).height());
  //console.log("width " + $(window).width());
	
  //region set nColumns
	var aTmpData = getDataOrMulti();
  var keys = Object.keys(aTmpData.length !== 0 ?  aTmpData[0] : {'':''});
  nColumns = keys.length;
  //endregion
	var _isMultiple = isMultiple(tmpChart);
	if (dataTmp.length && (isAgain || _isMultiple))
  {
		if (_isMultiple)
      typeChart = tmpChart;
    isAgain = false;
  }
  else
  {
    dataTmp = [];
		var aTmp = getDataOrMulti();
    aTmp.forEach(element => {
			var copied = Object.assign({}, element);
			indexIgnore.forEach(index => {
        delete copied[`time_${index}`];
      });
			dataTmp.push(copied);
		});
		if (typeChart != tmpChart || isReload) {
      typeChart = tmpChart;
    }
  }

  updateSize();
  //region choose table or chart
  switch (tmpChart) {
    case TypeEnum.TABLE:
    case TypeEnum.PIVOT:
      $("svg").hide(0);
      var aID = tmpChart == TypeEnum.TABLE ? ["idTableBasic", "idTableDataPivot"] : ["idTableDataPivot", "idTableBasic"];
      $(`#${aID[0]}`).show(0);
      $(`#${aID[1]}`).hide(0);
      break;
    default:
      $("#idTableBasic").hide(0);
      $("#idTableDataPivot").hide(0);
      clearSvg();
      switch(typeChart) {
        case TypeEnum.COLUMN:
          if (nColumns == 2) {
            setColumn();
          } else {
            setMultiColumn();
          }
        break;
        case TypeEnum.BAR:
          if (nColumns == 2) {
              setBar();
            } else {
              setMultiBar();
            }
          break;
        case TypeEnum.LINE:
          if (nColumns == 2) {
            setLine();
          } else {
            setMultiLine();
          }
          break;
        case TypeEnum.PIE:
          setDonut();
          break;
				case TypeEnum.HEATMAP:
					setHeatMap();
					break;
				case TypeEnum.BUBBLE:
          setBubble();
          break;
        case TypeEnum.STACKED_BAR:
          setStackedBar();
          break;
				case TypeEnum.STACKED_COLUMN:
					setStackedColumn();
					break;
      }
      break;
  }
  //endregion
}

function drillDown(content) {
	try {
		Android.drillDown(content);
	} catch(err) {
		console.log("Good content: " + content);
	};
}

function modalCategories(type, content) {
  try {
		Android.modalCategories(type, content);
	} catch(err) {
		console.log(`Good content: ${content}; ${type}`);
	};
}

function updateSelected(index_value) {
  try {
    Android.updateSelected(index_value);
  } catch (err) {
    console.log(`Good content: ${index_value}`);
  }
}

function getAxisX() {
  var extra = '';
  if (nColumns > 2) {
    extra = '▼';
  }
  return `${axisX} ${extra}`;
}

function getAxisY() {
  var extra = '';
  if (nColumns > 2) {
    extra = '▼';
  }
  return `${axisY} ${extra}`;
}

function svgMulti() {
  var svg = d3.select('body').append('svg')
		.attr('width', width + margin.bottom + margin.right)
		.attr('height', height + margin.top + margin.left + 30);
  return svg;
}

function addText(svg, textAnchor, fontSize, rotate, x, y, fillColor, id, text, click) {
  svg.append('text')
		.attr('text-anchor', textAnchor)
		.style('font-size', fontSize)
    .attr('transform', `rotate(${rotate})`)
		.attr('x', x)//for center
		.attr('y', y)//for set on bottom with -10
		.attr('fill', fillColor)
		.attr('id', id)
		.text(text)
    .on('click', click);
}

function addCircle(svg, cx, cy, r, fill, id, fStyle, fClick) {
  svg.append('circle')
    .attr('cx', cx)
    .attr('cy', cy)
    .attr('r', r)
    .attr('fill', fill)
    .attr('id', id)
    .attr('style', fStyle)
    .on('click', fClick);
}

function splitAxis(x) {
  return `${getFirst10(x.split('_')[0])}`;
}

function formatAxis(y) {
  return `${fformat(y)}`;
}

function axisMulti(svg, isLeft, xBand, height, _tickSize, formatAxis) {
  var svg = svg.append("g");
  if (height !== undefined)
  {
    svg = svg.attr('transform', `translate(0,${height})`)
  }
  var axis = isLeft ? d3.axisLeft(xBand) : d3.axisBottom(xBand);
  axis = axis.tickSize(_tickSize).tickFormat(x => formatAxis(x));
	svg.call(axis);
  return svg;
}

function completeAxisMultiple(axis, pointX, pointY, rotate) {
  axis
    .selectAll('text')
    //rotate text
    .attr('transform', `translate(${pointX}, ${pointY})rotate(${rotate})`)
    //Set color each item on X axis
    .attr('fill', '#909090')
    .style('text-anchor', 'end');
}

function setMultiCategory(aIndex, _IsCurrency, onlyIndex) {
	if (onlyIndex !== undefined) {
    var aTmp = _IsCurrency ? aCategory : aCategory2;
    axisY = aTmp[onlyIndex];
  } else {
    axisY = _IsCurrency ? 'Amount' : 'Quantity';
  }
  indexIgnore = [];
  aIndex.forEach(index => {
    indexIgnore.push(index);
  });
	isCurrency = _IsCurrency;
  dataTmp = [];
  updateData(typeChart, true);
}

function setIndexData(indexRoot, indexCommon) {
  var common = aCommon[indexCommon];
  axisX = common;
  indexData = indexRoot;
  dataTmp = [];
  updateData(typeChart, true);
}

//region not mutable
const TypeEnum = Object.freeze({
  "TABLE": 1,
  "PIVOT": 2,
  "COLUMN": 3,
  "BAR": 4,
  "LINE": 5,
  "PIE": 6,
  "HEATMAP": 7,
  "BUBBLE": 8,
  "STACKED_BAR": 9,
  "STACKED_COLUMN": 10,
  "STACKED_AREA": 11,
  "UNKNOWN": 0});
	
const TypeManage = Object.freeze({
	'CATEGORIES': 'CATEGORIES',
	'DATA': 'DATA',
  'SELECTABLE': 'SELECTABLE',
  'PLAIN': 'PLAIN'
});

var backgroundColor = '#3b3f46';
var colorPie = ["#26a7e9", "#a5cd39", "#dd6a6a", "#ffa700", "#00c1b2"];
var colorBi = ['#26a7e9'];//Main color for bars

var axisX = 'Invoice Date';
var axisY = 'Amount';
var axisMiddle = '';
var nColumns = 0;

//Main data
var hasNegative = {'0_1': true,'0_2': false,'1_1': true,'1_2': false,'2_1': false,'2_2': false,'3_1': true,'3_2': false,'5_1': false,'5_2': false,'6_1': false,'6_2': false,'7_1': true,'7_2': false,'9_1': true,'9_2': false,'11_1': true,'11_2': false,'12_1': false,'12_2': false,'13_1': true,'13_2': false,'14_1': false,'14_2': false, };
var indexData = 3;
var dataTmp = [];
var data = [];
var aStacked = [];
var aStacked2 = [];
var aStackedTmp = [];
var aCategoryX = [];
var data2 = [];
var aAllData = {'0_1': [{name: 'INV00000001_1', time_0: 5213.25, time_1: 248.25},
{name: 'INV00000002_1', time_0: 4389.0, time_1: 209.0},
{name: 'INV00000003_1', time_0: 3150.0, time_1: 150.0},
{name: 'INV00000004_1', time_0: 2173.5, time_1: 103.5},
{name: 'INV00000005_1', time_0: 1905.75, time_1: 90.75},
{name: 'INV00000006_1', time_0: 2688.0, time_1: 128.0},
{name: 'INV00000007_1', time_0: 2688.0, time_1: 128.0},
{name: 'INV00000008_1', time_0: 2688.0, time_1: 128.0},
{name: 'INV00000009_1', time_0: 3150.0, time_1: 150.0},
{name: 'INV00000010_1', time_0: 3150.0, time_1: 150.0},
{name: 'INV00000011_1', time_0: 577.5, time_1: 27.5},
{name: 'INV00000012_1', time_0: 2493.75, time_1: 118.75},
{name: 'INV00000013_1', time_0: 1220.62, time_1: 58.12},
{name: 'INV00000014_1', time_0: 4168.5, time_1: 198.5},
{name: 'INV00000015_1', time_0: 6258.0, time_1: 298.0},
{name: 'INV00000016_1', time_0: 6258.0, time_1: 298.0},
{name: 'INV00000017_1', time_0: 2756.25, time_1: 131.25},
{name: 'INV00000018_1', time_0: 2226.0, time_1: 106.0},
{name: 'INV00000019_1', time_0: 1244.25, time_1: 59.25},
{name: 'INV00000020_1', time_0: 957.6, time_1: 45.6},
{name: 'INV00000030_1', time_0: -1890.0, time_1: -90.0},
{name: 'INV00000031_1', time_0: -798.0, time_1: -38.0},
{name: 'INV00000032_1', time_0: -2992.5, time_1: -142.5},
{name: 'INV00000033_1', time_0: -5213.25, time_1: -248.25},
{name: 'INV00000021_1', time_0: 5670.0, time_1: 270.0},
{name: 'INV00000024_1', time_0: 14806.56, time_1: 705.06},
{name: 'INV00000022_1', time_0: 14806.56, time_1: 705.06},
{name: 'INV00000023_1', time_0: 2992.5, time_1: 142.5},
{name: 'INV00000025_1', time_0: 2992.5, time_1: 142.5},
{name: 'INV00000038_1', time_0: -1107.75, time_1: -52.75},
{name: 'INV00000026_1', time_0: 1060.5, time_1: 50.5},
{name: 'INV00000028_1', time_0: 966.0, time_1: 46.0},
{name: 'INV00000029_1', time_0: 593.25, time_1: 28.25},
{name: 'INV00000037_1', time_0: -677.25, time_1: -32.25},
{name: 'INV00000034_1', time_0: -351.75, time_1: -16.75},
{name: 'INV00000035_1', time_0: -315.0, time_1: -15.0},
{name: 'INV00000036_1', time_0: -10500.0, time_1: -500.0},
{name: 'INV00000039_1', time_0: 307.12, time_1: 14.62},
{name: 'INV00000042_1', time_0: 12400.5, time_1: 590.5},
{name: 'INV00000043_1', time_0: 1338.75, time_1: 63.75},
{name: 'INV00000044_1', time_0: 1107.75, time_1: 52.75},
{name: 'INV00000040_1', time_0: 4488.75, time_1: 213.75},
{name: 'INV00000041_1', time_0: 1890.0, time_1: 90.0},
{name: 'INV00000045_1', time_0: 252.0, time_1: 12.0},
{name: 'INV00000046_1', time_0: 1876.87, time_1: 89.37},
{name: 'INV00000047_1', time_0: 1449.0, time_1: 69.0},
{name: 'INV00000049_1', time_0: 336.0, time_1: 16.0},
{name: 'INV00000048_1', time_0: 351.74, time_1: 16.74},
{name: 'INV00000050_1', time_0: 220.5, time_1: 10.5},
{name: 'INV00000051_1', time_0: 236.25, time_1: 11.25},
{name: 'INV00000052_1', time_0: 2310.0, time_1: 110.0},
{name: 'INV00000055_1', time_0: 7896.0, time_1: 376.0},
{name: 'INV00000056_1', time_0: 5250.0, time_1: 250.0},
{name: 'INV00000057_1', time_0: 682.5, time_1: 32.5},
{name: 'INV00000058_1', time_0: 525.0, time_1: 25.0},
{name: 'INV00000059_1', time_0: 2200.0, time_1: 0.0}],
'0_2': [{name: 'INV00000001_1', time_0: 0.0},
{name: 'INV00000002_1', time_0: 0.0},
{name: 'INV00000003_1', time_0: 0.0},
{name: 'INV00000004_1', time_0: 0.0},
{name: 'INV00000005_1', time_0: 0.0},
{name: 'INV00000006_1', time_0: 0.0},
{name: 'INV00000007_1', time_0: 0.0},
{name: 'INV00000008_1', time_0: 0.0},
{name: 'INV00000009_1', time_0: 0.0},
{name: 'INV00000010_1', time_0: 0.0},
{name: 'INV00000011_1', time_0: 0.0},
{name: 'INV00000012_1', time_0: 0.0},
{name: 'INV00000013_1', time_0: 0.0},
{name: 'INV00000014_1', time_0: 0.0},
{name: 'INV00000015_1', time_0: 0.0},
{name: 'INV00000016_1', time_0: 0.0},
{name: 'INV00000017_1', time_0: 0.0},
{name: 'INV00000018_1', time_0: 0.0},
{name: 'INV00000019_1', time_0: 0.0},
{name: 'INV00000020_1', time_0: 0.0},
{name: 'INV00000030_1', time_0: 0.0},
{name: 'INV00000031_1', time_0: 0.0},
{name: 'INV00000032_1', time_0: 0.0},
{name: 'INV00000033_1', time_0: 0.0},
{name: 'INV00000021_1', time_0: 0.0},
{name: 'INV00000024_1', time_0: 0.0},
{name: 'INV00000022_1', time_0: 0.0},
{name: 'INV00000023_1', time_0: 0.0},
{name: 'INV00000025_1', time_0: 0.0},
{name: 'INV00000038_1', time_0: 0.0},
{name: 'INV00000026_1', time_0: 0.0},
{name: 'INV00000028_1', time_0: 0.0},
{name: 'INV00000029_1', time_0: 0.0},
{name: 'INV00000037_1', time_0: 0.0},
{name: 'INV00000034_1', time_0: 0.0},
{name: 'INV00000035_1', time_0: 0.0},
{name: 'INV00000036_1', time_0: 0.0},
{name: 'INV00000039_1', time_0: 0.0},
{name: 'INV00000042_1', time_0: 0.0},
{name: 'INV00000043_1', time_0: 0.0},
{name: 'INV00000044_1', time_0: 0.0},
{name: 'INV00000040_1', time_0: 0.0},
{name: 'INV00000041_1', time_0: 0.0},
{name: 'INV00000045_1', time_0: 0.0},
{name: 'INV00000046_1', time_0: 0.0},
{name: 'INV00000047_1', time_0: 0.0},
{name: 'INV00000049_1', time_0: 0.0},
{name: 'INV00000048_1', time_0: 0.0},
{name: 'INV00000050_1', time_0: 0.0},
{name: 'INV00000051_1', time_0: 0.0},
{name: 'INV00000052_1', time_0: 0.0},
{name: 'INV00000055_1', time_0: 0.0},
{name: 'INV00000056_1', time_0: 0.0},
{name: 'INV00000057_1', time_0: 0.0},
{name: 'INV00000058_1', time_0: 0.0},
{name: 'INV00000059_1', time_0: 0.0}],
'1_1': [{name: 'AR00000001_1', time_0: 5213.25, time_1: 248.25},
{name: 'AR00000002_1', time_0: 4389.0, time_1: 209.0},
{name: 'AR00000003_1', time_0: 3150.0, time_1: 150.0},
{name: 'AR00000004_1', time_0: 4079.25, time_1: 194.25},
{name: 'AR00000005_1', time_0: 8064.0, time_1: 384.0},
{name: 'AR00000006_1', time_0: 10591.869999999999, time_1: 504.37},
{name: 'AR00000007_1', time_0: 23868.6, time_1: 1136.6},
{name: 'AR00000015_1', time_0: -1890.0, time_1: -90.0},
{name: 'AR00000016_1', time_0: -798.0, time_1: -38.0},
{name: 'AR00000017_1', time_0: -2992.5, time_1: -142.5},
{name: 'AR00000018_1', time_0: -5213.25, time_1: -248.25},
{name: 'AR00000008_1', time_0: 5670.0, time_1: 270.0},
{name: 'AR00000010_1', time_0: 17799.059999999998, time_1: 847.56},
{name: 'AR00000009_1', time_0: 17799.059999999998, time_1: 847.56},
{name: 'AR00000023_1', time_0: -1107.75, time_1: -52.75},
{name: 'AR00000011_1', time_0: 1060.5, time_1: 50.5},
{name: 'AR00000013_1', time_0: 966.0, time_1: 46.0},
{name: 'AR00000014_1', time_0: 593.25, time_1: 28.25},
{name: 'AR00000022_1', time_0: -677.25, time_1: -32.25},
{name: 'AR00000019_1', time_0: -351.75, time_1: -16.75},
{name: 'AR00000020_1', time_0: -315.0, time_1: -15.0},
{name: 'AR00000021_1', time_0: -10500.0, time_1: -500.0},
{name: 'AR00000024_1', time_0: 307.12, time_1: 14.62},
{name: 'AR00000025_1', time_0: 20118.0, time_1: 958.0},
{name: 'AR00000026_1', time_0: 1107.75, time_1: 52.75},
{name: 'AR00000027_1', time_0: 252.0, time_1: 12.0},
{name: 'AR00000028_1', time_0: 3325.87, time_1: 158.37},
{name: 'AR00000030_1', time_0: 336.0, time_1: 16.0},
{name: 'AR00000029_1', time_0: 351.74, time_1: 16.74},
{name: 'AR00000031_1', time_0: 220.5, time_1: 10.5},
{name: 'AR00000032_1', time_0: 2546.25, time_1: 121.25},
{name: 'AR00000034_1', time_0: 7896.0, time_1: 376.0},
{name: 'AR00000035_1', time_0: 5250.0, time_1: 250.0},
{name: 'AR00000036_1', time_0: 682.5, time_1: 32.5},
{name: 'AR00000037_1', time_0: 525.0, time_1: 25.0},
{name: 'AR00000038_1', time_0: 2200.0, time_1: 0.0}],
'1_2': [{name: 'AR00000001_1', time_0: 0.0},
{name: 'AR00000002_1', time_0: 0.0},
{name: 'AR00000003_1', time_0: 0.0},
{name: 'AR00000004_1', time_0: 0.0},
{name: 'AR00000005_1', time_0: 0.0},
{name: 'AR00000006_1', time_0: 0.0},
{name: 'AR00000007_1', time_0: 0.0},
{name: 'AR00000015_1', time_0: 0.0},
{name: 'AR00000016_1', time_0: 0.0},
{name: 'AR00000017_1', time_0: 0.0},
{name: 'AR00000018_1', time_0: 0.0},
{name: 'AR00000008_1', time_0: 0.0},
{name: 'AR00000010_1', time_0: 0.0},
{name: 'AR00000009_1', time_0: 0.0},
{name: 'AR00000023_1', time_0: 0.0},
{name: 'AR00000011_1', time_0: 0.0},
{name: 'AR00000013_1', time_0: 0.0},
{name: 'AR00000014_1', time_0: 0.0},
{name: 'AR00000022_1', time_0: 0.0},
{name: 'AR00000019_1', time_0: 0.0},
{name: 'AR00000020_1', time_0: 0.0},
{name: 'AR00000021_1', time_0: 0.0},
{name: 'AR00000024_1', time_0: 0.0},
{name: 'AR00000025_1', time_0: 0.0},
{name: 'AR00000026_1', time_0: 0.0},
{name: 'AR00000027_1', time_0: 0.0},
{name: 'AR00000028_1', time_0: 0.0},
{name: 'AR00000030_1', time_0: 0.0},
{name: 'AR00000029_1', time_0: 0.0},
{name: 'AR00000031_1', time_0: 0.0},
{name: 'AR00000032_1', time_0: 0.0},
{name: 'AR00000034_1', time_0: 0.0},
{name: 'AR00000035_1', time_0: 0.0},
{name: 'AR00000036_1', time_0: 0.0},
{name: 'AR00000037_1', time_0: 0.0},
{name: 'AR00000038_1', time_0: 0.0}],
'2_1': [{name: 'Sirocco Enterprises_1', time_0: 5727.75, time_1: 272.75},
{name: 'Bill & Sons_1', time_0: 54141.119999999995, time_1: 2578.12},
{name: 'Great Big North_1', time_0: 11353.12, time_1: 540.62},
{name: 'Petronix Inc._1', time_0: 12786.369999999999, time_1: 608.87},
{name: 'Clark Resources_1', time_0: 1727.25, time_1: 82.25},
{name: 'Marshall Fluid Hauling Services_1', time_0: 3110.0899999999997, time_1: 148.09},
{name: 'Southern Trucking and Services_1', time_0: 17855.25, time_1: 850.25},
{name: 'Canadian Business Corporation_1', time_0: 2950.5, time_1: 140.5},
{name: 'American Business Corporation_1', time_0: 3325.87, time_1: 158.37},
{name: 'Chesapeake Energy_1', time_0: 236.25, time_1: 11.25},
{name: 'Shell_1', time_0: 10096.0, time_1: 376.0},
{name: 'Rice Energy_1', time_0: 682.5, time_1: 32.5},
{name: 'Advantage Oil_1', time_0: 525.0, time_1: 25.0}],
'2_2': [{name: 'Sirocco Enterprises_1', time_0: 0.0},
{name: 'Bill & Sons_1', time_0: 0.0},
{name: 'Great Big North_1', time_0: 0.0},
{name: 'Petronix Inc._1', time_0: 0.0},
{name: 'Clark Resources_1', time_0: 0.0},
{name: 'Marshall Fluid Hauling Services_1', time_0: 0.0},
{name: 'Southern Trucking and Services_1', time_0: 0.0},
{name: 'Canadian Business Corporation_1', time_0: 0.0},
{name: 'American Business Corporation_1', time_0: 0.0},
{name: 'Chesapeake Energy_1', time_0: 0.0},
{name: 'Shell_1', time_0: 0.0},
{name: 'Rice Energy_1', time_0: 0.0},
{name: 'Advantage Oil_1', time_0: 0.0}],
'3_1': [{name: 'Jun 7, 2016_1', time_0: 9602.25, time_1: 457.25},
{name: 'Jul 10, 2016_1', time_0: 15293.25, time_1: 728.25},
{name: 'Jul 14, 2016_1', time_0: 10591.869999999999, time_1: 504.37},
{name: 'Jul 24, 2016_1', time_0: 23868.6, time_1: 1136.6},
{name: 'Jul 31, 2016_1', time_0: -1890.0, time_1: -90.0},
{name: 'Aug 14, 2016_1', time_0: -798.0, time_1: -38.0},
{name: 'Nov 6, 2016_1', time_0: -8205.75, time_1: -390.75},
{name: 'Dec 11, 2016_1', time_0: 5670.0, time_1: 270.0},
{name: 'Jan 13, 2017_1', time_0: 35598.119999999995, time_1: 1695.12},
{name: 'Feb 5, 2017_1', time_0: -1107.75, time_1: -52.75},
{name: 'Feb 6, 2017_1', time_0: 2619.75, time_1: 124.75},
{name: 'Feb 26, 2017_1', time_0: -677.25, time_1: -32.25},
{name: 'Feb 27, 2017_1', time_0: -11166.75, time_1: -531.75},
{name: 'Mar 21, 2017_1', time_0: 307.12, time_1: 14.62},
{name: 'Mar 22, 2017_1', time_0: 21225.75, time_1: 1010.75},
{name: 'Mar 23, 2017_1', time_0: 252.0, time_1: 12.0},
{name: 'Nov 15, 2017_1', time_0: 3325.87, time_1: 158.37},
{name: 'Dec 4, 2017_1', time_0: 687.74, time_1: 32.739999999999995},
{name: 'Dec 5, 2017_1', time_0: 220.5, time_1: 10.5},
{name: 'Dec 12, 2017_1', time_0: 2546.25, time_1: 121.25},
{name: 'Dec 13, 2017_1', time_0: 7896.0, time_1: 376.0},
{name: 'Feb 23, 2018_1', time_0: 5250.0, time_1: 250.0},
{name: 'Sep 1, 2019_1', time_0: 682.5, time_1: 32.5},
{name: 'Oct 18, 2019_1', time_0: 525.0, time_1: 25.0},
{name: 'Nov 6, 2019_1', time_0: 2200.0, time_1: 0.0}],
'3_2': [{name: 'Jun 7, 2016_1', time_0: 0.0},
{name: 'Jul 10, 2016_1', time_0: 0.0},
{name: 'Jul 14, 2016_1', time_0: 0.0},
{name: 'Jul 24, 2016_1', time_0: 0.0},
{name: 'Jul 31, 2016_1', time_0: 0.0},
{name: 'Aug 14, 2016_1', time_0: 0.0},
{name: 'Nov 6, 2016_1', time_0: 0.0},
{name: 'Dec 11, 2016_1', time_0: 0.0},
{name: 'Jan 13, 2017_1', time_0: 0.0},
{name: 'Feb 5, 2017_1', time_0: 0.0},
{name: 'Feb 6, 2017_1', time_0: 0.0},
{name: 'Feb 26, 2017_1', time_0: 0.0},
{name: 'Feb 27, 2017_1', time_0: 0.0},
{name: 'Mar 21, 2017_1', time_0: 0.0},
{name: 'Mar 22, 2017_1', time_0: 0.0},
{name: 'Mar 23, 2017_1', time_0: 0.0},
{name: 'Nov 15, 2017_1', time_0: 0.0},
{name: 'Dec 4, 2017_1', time_0: 0.0},
{name: 'Dec 5, 2017_1', time_0: 0.0},
{name: 'Dec 12, 2017_1', time_0: 0.0},
{name: 'Dec 13, 2017_1', time_0: 0.0},
{name: 'Feb 23, 2018_1', time_0: 0.0},
{name: 'Sep 1, 2019_1', time_0: 0.0},
{name: 'Oct 18, 2019_1', time_0: 0.0},
{name: 'Nov 6, 2019_1', time_0: 0.0}],
'5_1': [{name: '2_1', time_0: 101433.88999999998, time_1: 4725.389999999999},
{name: '4_1', time_0: 22188.059999999998, time_1: 1056.56},
{name: '3_1', time_0: 895.12, time_1: 42.62}],
'5_2': [{name: '2_1', time_0: 0.0},
{name: '4_1', time_0: 0.0},
{name: '3_1', time_0: 0.0}],
'6_1': [{name: 'Due in 30 days._1', time_0: 118847.06999999998, time_1: 5554.569999999999},
{name: 'Due on receipt_1', time_0: 5670.0, time_1: 270.0}],
'6_2': [{name: 'Due in 30 days._1', time_0: 0.0},
{name: 'Due on receipt_1', time_0: 0.0}],
'7_1': [{name: 'Jun 7, 2016_1', time_0: 9602.25, time_1: 457.25},
{name: 'Jul 10, 2016_1', time_0: 15293.25, time_1: 728.25},
{name: 'Jul 14, 2016_1', time_0: 10591.869999999999, time_1: 504.37},
{name: 'Jun 18, 2016_1', time_0: 23868.6, time_1: 1136.6},
{name: 'Jul 31, 2016_1', time_0: -1890.0, time_1: -90.0},
{name: 'Aug 14, 2016_1', time_0: -798.0, time_1: -38.0},
{name: 'Nov 6, 2016_1', time_0: -8205.75, time_1: -390.75},
{name: 'Dec 11, 2016_1', time_0: 5670.0, time_1: 270.0},
{name: 'Jan 13, 2017_1', time_0: 35598.119999999995, time_1: 1695.12},
{name: 'Feb 5, 2017_1', time_0: -1107.75, time_1: -52.75},
{name: 'Feb 6, 2017_1', time_0: 2619.75, time_1: 124.75},
{name: 'Feb 26, 2017_1', time_0: -677.25, time_1: -32.25},
{name: 'Feb 27, 2017_1', time_0: -11166.75, time_1: -531.75},
{name: 'Mar 21, 2017_1', time_0: 307.12, time_1: 14.62},
{name: 'Mar 22, 2017_1', time_0: 21225.75, time_1: 1010.75},
{name: 'Mar 23, 2017_1', time_0: 252.0, time_1: 12.0},
{name: 'Nov 15, 2017_1', time_0: 3325.87, time_1: 158.37},
{name: 'Dec 4, 2017_1', time_0: 687.74, time_1: 32.739999999999995},
{name: 'Dec 5, 2017_1', time_0: 220.5, time_1: 10.5},
{name: 'Dec 12, 2017_1', time_0: 2546.25, time_1: 121.25},
{name: 'Dec 13, 2017_1', time_0: 7896.0, time_1: 376.0},
{name: 'Feb 23, 2018_1', time_0: 5250.0, time_1: 250.0},
{name: 'Sep 1, 2019_1', time_0: 682.5, time_1: 32.5},
{name: 'Oct 18, 2019_1', time_0: 525.0, time_1: 25.0},
{name: 'Nov 6, 2019_1', time_0: 2200.0, time_1: 0.0}],
'7_2': [{name: 'Jun 7, 2016_1', time_0: 0.0},
{name: 'Jul 10, 2016_1', time_0: 0.0},
{name: 'Jul 14, 2016_1', time_0: 0.0},
{name: 'Jun 18, 2016_1', time_0: 0.0},
{name: 'Jul 31, 2016_1', time_0: 0.0},
{name: 'Aug 14, 2016_1', time_0: 0.0},
{name: 'Nov 6, 2016_1', time_0: 0.0},
{name: 'Dec 11, 2016_1', time_0: 0.0},
{name: 'Jan 13, 2017_1', time_0: 0.0},
{name: 'Feb 5, 2017_1', time_0: 0.0},
{name: 'Feb 6, 2017_1', time_0: 0.0},
{name: 'Feb 26, 2017_1', time_0: 0.0},
{name: 'Feb 27, 2017_1', time_0: 0.0},
{name: 'Mar 21, 2017_1', time_0: 0.0},
{name: 'Mar 22, 2017_1', time_0: 0.0},
{name: 'Mar 23, 2017_1', time_0: 0.0},
{name: 'Nov 15, 2017_1', time_0: 0.0},
{name: 'Dec 4, 2017_1', time_0: 0.0},
{name: 'Dec 5, 2017_1', time_0: 0.0},
{name: 'Dec 12, 2017_1', time_0: 0.0},
{name: 'Dec 13, 2017_1', time_0: 0.0},
{name: 'Feb 23, 2018_1', time_0: 0.0},
{name: 'Sep 1, 2019_1', time_0: 0.0},
{name: 'Oct 18, 2019_1', time_0: 0.0},
{name: 'Nov 6, 2019_1', time_0: 0.0}],
'9_1': [{name: 'Jul 7, 2016_1', time_0: 9602.25, time_1: 457.25},
{name: 'Aug 9, 2016_1', time_0: 15293.25, time_1: 728.25},
{name: 'Aug 13, 2016_1', time_0: 10591.869999999999, time_1: 504.37},
{name: 'Jul 18, 2016_1', time_0: 23868.6, time_1: 1136.6},
{name: 'Aug 30, 2016_1', time_0: -1890.0, time_1: -90.0},
{name: 'Sep 13, 2016_1', time_0: -798.0, time_1: -38.0},
{name: 'Dec 6, 2016_1', time_0: -8205.75, time_1: -390.75},
{name: 'Dec 11, 2016_1', time_0: 5670.0, time_1: 270.0},
{name: 'Feb 12, 2017_1', time_0: 35598.119999999995, time_1: 1695.12},
{name: 'Mar 7, 2017_1', time_0: -1107.75, time_1: -52.75},
{name: 'Mar 8, 2017_1', time_0: 2619.75, time_1: 124.75},
{name: 'Mar 28, 2017_1', time_0: -677.25, time_1: -32.25},
{name: 'Mar 29, 2017_1', time_0: -11166.75, time_1: -531.75},
{name: 'Apr 20, 2017_1', time_0: 307.12, time_1: 14.62},
{name: 'Apr 21, 2017_1', time_0: 21225.75, time_1: 1010.75},
{name: 'Apr 22, 2017_1', time_0: 252.0, time_1: 12.0},
{name: 'Dec 15, 2017_1', time_0: 3325.87, time_1: 158.37},
{name: 'Jan 3, 2018_1', time_0: 687.74, time_1: 32.739999999999995},
{name: 'Jan 4, 2018_1', time_0: 220.5, time_1: 10.5},
{name: 'Jan 11, 2018_1', time_0: 2546.25, time_1: 121.25},
{name: 'Jan 12, 2018_1', time_0: 7896.0, time_1: 376.0},
{name: 'Mar 25, 2018_1', time_0: 5250.0, time_1: 250.0},
{name: 'Oct 1, 2019_1', time_0: 682.5, time_1: 32.5},
{name: 'Nov 17, 2019_1', time_0: 525.0, time_1: 25.0},
{name: 'Dec 6, 2019_1', time_0: 2200.0, time_1: 0.0}],
'9_2': [{name: 'Jul 7, 2016_1', time_0: 0.0},
{name: 'Aug 9, 2016_1', time_0: 0.0},
{name: 'Aug 13, 2016_1', time_0: 0.0},
{name: 'Jul 18, 2016_1', time_0: 0.0},
{name: 'Aug 30, 2016_1', time_0: 0.0},
{name: 'Sep 13, 2016_1', time_0: 0.0},
{name: 'Dec 6, 2016_1', time_0: 0.0},
{name: 'Dec 11, 2016_1', time_0: 0.0},
{name: 'Feb 12, 2017_1', time_0: 0.0},
{name: 'Mar 7, 2017_1', time_0: 0.0},
{name: 'Mar 8, 2017_1', time_0: 0.0},
{name: 'Mar 28, 2017_1', time_0: 0.0},
{name: 'Mar 29, 2017_1', time_0: 0.0},
{name: 'Apr 20, 2017_1', time_0: 0.0},
{name: 'Apr 21, 2017_1', time_0: 0.0},
{name: 'Apr 22, 2017_1', time_0: 0.0},
{name: 'Dec 15, 2017_1', time_0: 0.0},
{name: 'Jan 3, 2018_1', time_0: 0.0},
{name: 'Jan 4, 2018_1', time_0: 0.0},
{name: 'Jan 11, 2018_1', time_0: 0.0},
{name: 'Jan 12, 2018_1', time_0: 0.0},
{name: 'Mar 25, 2018_1', time_0: 0.0},
{name: 'Oct 1, 2019_1', time_0: 0.0},
{name: 'Nov 17, 2019_1', time_0: 0.0},
{name: 'Dec 6, 2019_1', time_0: 0.0}],
'11_1': [{name: 'J00000001_1', time_0: 4389.0, time_1: 209.0},
{name: 'J00000003_1', time_0: 15198.75, time_1: 723.75},
{name: 'J00000005_1', time_0: 18885.809999999998, time_1: 899.31},
{name: 'J00000004_1', time_0: 5376.0, time_1: 256.0},
{name: 'J00000008_1', time_0: 4291.87, time_1: 204.37},
{name: 'J00000002_1', time_0: 16684.5, time_1: 794.5},
{name: 'J00000006_1', time_0: 2226.0, time_1: 106.0},
{name: 'J00000007_1', time_0: 2201.85, time_1: 104.85},
{name: 'J00000499_1', time_0: 5670.0, time_1: 270.0},
{name: 'J00000765_1', time_0: 14806.56, time_1: 705.06},
{name: 'J00001078_1', time_0: 966.0, time_1: 46.0},
{name: 'J00001074_1', time_0: 1060.5, time_1: 50.5},
{name: 'J00001077_1', time_0: -498.75, time_1: -23.75},
{name: 'J00000496_1', time_0: -10500.0, time_1: -500.0},
{name: 'J00002164_1', time_0: 307.12, time_1: 14.62},
{name: 'J00002174_1', time_0: 6200.25, time_1: 295.25},
{name: 'J00002175_1', time_0: 6200.25, time_1: 295.25},
{name: 'J00002178_1', time_0: 1338.75, time_1: 63.75},
{name: 'J00002176_1', time_0: 4488.75, time_1: 213.75},
{name: 'J00002177_1', time_0: 1890.0, time_1: 90.0},
{name: 'J00003283_1', time_0: 3325.87, time_1: 158.37},
{name: 'J00000992_1', time_0: 908.24, time_1: 43.239999999999995},
{name: 'J00002831_1', time_0: 236.25, time_1: 11.25},
{name: 'J00002810_1', time_0: 2310.0, time_1: 110.0},
{name: 'J00003178_1', time_0: 7896.0, time_1: 376.0},
{name: 'J00004246_1', time_0: 5250.0, time_1: 250.0},
{name: 'J00003053_1', time_0: 682.5, time_1: 32.5},
{name: 'J00005642_1', time_0: 525.0, time_1: 25.0},
{name: 'J00000907_1', time_0: 2200.0, time_1: 0.0}],
'11_2': [{name: 'J00000001_1', time_0: 0.0},
{name: 'J00000003_1', time_0: 0.0},
{name: 'J00000005_1', time_0: 0.0},
{name: 'J00000004_1', time_0: 0.0},
{name: 'J00000008_1', time_0: 0.0},
{name: 'J00000002_1', time_0: 0.0},
{name: 'J00000006_1', time_0: 0.0},
{name: 'J00000007_1', time_0: 0.0},
{name: 'J00000499_1', time_0: 0.0},
{name: 'J00000765_1', time_0: 0.0},
{name: 'J00001078_1', time_0: 0.0},
{name: 'J00001074_1', time_0: 0.0},
{name: 'J00001077_1', time_0: 0.0},
{name: 'J00000496_1', time_0: 0.0},
{name: 'J00002164_1', time_0: 0.0},
{name: 'J00002174_1', time_0: 0.0},
{name: 'J00002175_1', time_0: 0.0},
{name: 'J00002178_1', time_0: 0.0},
{name: 'J00002176_1', time_0: 0.0},
{name: 'J00002177_1', time_0: 0.0},
{name: 'J00003283_1', time_0: 0.0},
{name: 'J00000992_1', time_0: 0.0},
{name: 'J00002831_1', time_0: 0.0},
{name: 'J00002810_1', time_0: 0.0},
{name: 'J00003178_1', time_0: 0.0},
{name: 'J00004246_1', time_0: 0.0},
{name: 'J00003053_1', time_0: 0.0},
{name: 'J00005642_1', time_0: 0.0},
{name: 'J00000907_1', time_0: 0.0}],
'12_1': [{name: 'Hydrovac_1', time_0: 121794.95999999999, time_1: 5694.959999999999},
{name: 'Well Servicing_1', time_0: 420.0, time_1: 20.0},
{name: 'Fluid Hauling_1', time_0: 1777.1099999999997, time_1: 84.61},
{name: 'Truck Hauling_1', time_0: 525.0, time_1: 25.0}],
'12_2': [{name: 'Hydrovac_1', time_0: 0.0},
{name: 'Well Servicing_1', time_0: 0.0},
{name: 'Fluid Hauling_1', time_0: 0.0},
{name: 'Truck Hauling_1', time_0: 0.0}],
'13_1': [{name: 'Southern Alberta_1', time_0: 58700.25, time_1: 2795.25},
{name: 'Northern Alberta_1', time_0: 46544.369999999995, time_1: 2216.37},
{name: 'Central Saskatchewan_1', time_0: 6493.72, time_1: 309.22},
{name: 'Louisiana_1', time_0: 7696.5, time_1: 366.5},
{name: 'Midland, TX_1', time_0: 1091.99, time_1: 51.989999999999995},
{name: 'Texas_1', time_0: 428.1200000000008, time_1: -84.38},
{name: 'ABC Truckline_1', time_0: 3325.87, time_1: 158.37},
{name: 'Northern BC_1', time_0: 236.25, time_1: 11.25}],
'13_2': [{name: 'Southern Alberta_1', time_0: 0.0},
{name: 'Northern Alberta_1', time_0: 0.0},
{name: 'Central Saskatchewan_1', time_0: 0.0},
{name: 'Louisiana_1', time_0: 0.0},
{name: 'Midland, TX_1', time_0: 0.0},
{name: 'Texas_1', time_0: 0.0},
{name: 'ABC Truckline_1', time_0: 0.0},
{name: 'Northern BC_1', time_0: 0.0}],
'14_1': [{name: 'Alberta_1', time_0: 90970.93, time_1: 4331.929999999999},
{name: 'Saskatchewan_1', time_0: 2201.85, time_1: 104.85},
{name: 'New Mexico_1', time_0: 5670.0, time_1: 270.0},
{name: 'Untitled Category_1', time_0: 21697.18, time_1: 1033.1799999999998},
{name: 'Louisiana_1', time_0: 1060.5, time_1: 50.5},
{name: 'Texas_1', time_0: 2609.49, time_1: 19.49},
{name: 'Oklahoma_1', time_0: 307.12, time_1: 14.62}],
'14_2': [{name: 'Alberta_1', time_0: 0.0},
{name: 'Saskatchewan_1', time_0: 0.0},
{name: 'New Mexico_1', time_0: 0.0},
{name: 'Untitled Category_1', time_0: 0.0},
{name: 'Louisiana_1', time_0: 0.0},
{name: 'Texas_1', time_0: 0.0},
{name: 'Oklahoma_1', time_0: 0.0}],
 };
var aMaxData = {'0_1': [14806, 705],
'0_2': [0],
'1_1': [23868, 1136],
'1_2': [0],
'2_1': [54141, 2578],
'2_2': [0],
'3_1': [35598, 1695],
'3_2': [0],
'5_1': [101433, 4725],
'5_2': [0],
'6_1': [118847, 5554],
'6_2': [0],
'7_1': [35598, 1695],
'7_2': [0],
'9_1': [35598, 1695],
'9_2': [0],
'11_1': [18885, 899],
'11_2': [0],
'12_1': [121794, 5694],
'12_2': [0],
'13_1': [58700, 2795],
'13_2': [0],
'14_1': [90970, 4331],
'14_2': [0],
 };
var dataFormatted = [];
var opacityMarked = [];
var indexIgnore = [];
var drillTableY = [];
var drillX = ['1465344000','1468195200','1468540800','1469404800','1470009600','1471219200','1478476800','1481500800','1484308800','1486339200','1486382400','1488153600','1488240000','1490097600','1490184000','1490270400','1510790400','1512388800','1512475200','1513080000','1513166400','1519387200','1567339200','1571400000','1573041600'];
var aDrillData = {0: ['INV00000001','INV00000002','INV00000003','INV00000004','INV00000005','INV00000006','INV00000007','INV00000008','INV00000009','INV00000010','INV00000011','INV00000012','INV00000013','INV00000014','INV00000015','INV00000016','INV00000017','INV00000018','INV00000019','INV00000020','INV00000030','INV00000031','INV00000032','INV00000033','INV00000021','INV00000024','INV00000022','INV00000023','INV00000025','INV00000038','INV00000026','INV00000028','INV00000029','INV00000037','INV00000034','INV00000035','INV00000036','INV00000039','INV00000042','INV00000043','INV00000044','INV00000040','INV00000041','INV00000045','INV00000046','INV00000047','INV00000049','INV00000048','INV00000050','INV00000051','INV00000052','INV00000055','INV00000056','INV00000057','INV00000058','INV00000059'],
1: ['AR00000001','AR00000002','AR00000003','AR00000004','AR00000005','AR00000006','AR00000007','AR00000015','AR00000016','AR00000017','AR00000018','AR00000008','AR00000010','AR00000009','AR00000023','AR00000011','AR00000013','AR00000014','AR00000022','AR00000019','AR00000020','AR00000021','AR00000024','AR00000025','AR00000026','AR00000027','AR00000028','AR00000030','AR00000029','AR00000031','AR00000032','AR00000034','AR00000035','AR00000036','AR00000037','AR00000038'],
2: ['Sirocco Enterprises','Bill & Sons','Great Big North','Petronix Inc.','Clark Resources','Marshall Fluid Hauling Services','Southern Trucking and Services','Canadian Business Corporation','American Business Corporation','Chesapeake Energy','Shell','Rice Energy','Advantage Oil'],
3: ['1465344000','1468195200','1468540800','1469404800','1470009600','1471219200','1478476800','1481500800','1484308800','1486339200','1486382400','1488153600','1488240000','1490097600','1490184000','1490270400','1510790400','1512388800','1512475200','1513080000','1513166400','1519387200','1567339200','1571400000','1573041600'],
5: ['2','4','3'],
6: ['Due in 30 days.','Due on receipt'],
7: ['1465344000','1468195200','1468540800','1466294400','1470009600','1471219200','1478476800','1481500800','1484308800','1486339200','1486382400','1488153600','1488240000','1490097600','1490184000','1490270400','1510790400','1512388800','1512475200','1513080000','1513166400','1519387200','1567339200','1571400000','1573041600'],
9: ['1467936000','1470787200','1471132800','1468886400','1472601600','1473811200','1481068800','1481500800','1486900800','1488931200','1488974400','1490745600','1490832000','1492689600','1492776000','1492862400','1513382400','1514980800','1515067200','1515672000','1515758400','1521979200','1569931200','1573992000','1575633600'],
11: ['J00000001','J00000003','J00000005','J00000004','J00000008','J00000002','J00000006','J00000007','J00000499','J00000765','J00001078','J00001074','J00001077','J00000496','J00002164','J00002174','J00002175','J00002178','J00002176','J00002177','J00003283','J00000992','J00002831','J00002810','J00003178','J00004246','J00003053','J00005642','J00000907'],
12: ['Hydrovac','Well Servicing','Fluid Hauling','Truck Hauling'],
13: ['Southern Alberta','Northern Alberta','Central Saskatchewan','Louisiana','Midland, TX','Texas','ABC Truckline','Northern BC'],
14: ['Alberta','Saskatchewan','New Mexico','Untitled Category','Louisiana','Texas','Oklahoma'],
 };
var limitName = 0;
var isCurrency = true;
var maxValue = 35598;
var minValue = -11166;
var maxValue2 = 0;
var minValue2 = 0;
var aMax = [35598, 1695];
var aMax2 = [0];
var aMin = [-11166, -531];
var aMin2 = [0];
var aCategory = ['Invoice Amount','Tax'];
var aCategory2 = ['Discount Percent'];
var aCommon = ["Invoice Number", "Batch", "Customer", "Invoice Date", "Invoice Status", "Term", "Discount Date", "Due Date", "Job", "Job Type", "Area", "Province"];
//endregion
//axis X for heatmap
var aCatHeatX = [];
//axis Y for heatmap
var aCatHeatY = [];

//REGION max letters in name
for (const item in getDataOrMulti()) {
  var value = getDataOrMulti()[item].name.length;
  if (limitName < value) {
    limitName = value;
    if (limitName > 10) {
      limitName = 110;
      break;
    } else {
      limitName *= 10;
    }
  }
}
//ENDREGION

//REGION get max value
for (const item in getDataOrMulti()) {
  var value = getDataOrMulti()[item].value;
  if (getMaxValue() < value) {
    maxValue = value;
  }
}
//ENDREGION

//The left margin makes the left border visible
const marginAxis = 0;
var typeChart = TypeEnum.COLUMN;
var digits = digitsCount(getMaxValue());
var _plusSingle = digits == 1 ? 10 : 0;
var _maxValue = (digits * 10) + _plusSingle;
var _bottom = (isHorizontal() ? _maxValue : limitName) + marginAxis;
var _left = (isHorizontal() ? limitName : _maxValue) + marginAxis;
//width dynamic, height dynamic
var margin = {
  top: 20,
  right: 20,
  bottom: _bottom,
  left: _left
};
var width = 0;
var height = 0;
var isAgain = false;

function setStackedBar() {
  var svg = svgMulti().append('g')
		.attr('transform', `translate(${margin.left + 60}, ${margin.top})`);

	var withReduce = width - 100;
	//region rewrite
  var subgroups = [];
	var stackedData = getStackedData();
  stackedData.map(function(a1) {
    var keys1 = Object.keys(a1);
    keys1.map(function(b1) {
      if (b1 != 'name' && subgroups.indexOf(b1) === -1) {
        subgroups.push(b1);
      }
    });
  });
  //endregion
  var groups = [];
  stackedData.map(function(item) {
    var vGroup = item.name;
    if (groups.indexOf(vGroup) === -1) {
      groups.push(vGroup);
    }
  });
  // Add X axis
  var x = d3.scaleBand()
    .domain(groups)
    .range([0, height])
    .padding(0.2);
  svg.append('g')
    .call(d3.axisLeft(x)
      .tickSize(7)
      .tickSizeOuter(0)
			.tickFormat(x =>`${getFirst10(x)}`)
		)
  //set color for domain and ticks
    .style("color", '#909090');

  // Add Y axis
  var y = d3.scaleLinear()
    .domain([0, getStackedMax()])
    .range([0, withReduce]);
  svg.append('g')
    .attr('transform', 'translate(0,' + height + ')')
    .call(
      d3.axisBottom(y)
      .tickSize(0))
    .call(
			g => g.selectAll('.tick line')
			.clone()
			.attr('stroke-opacity', 0.1)
			.attr('y2', -height))
    //Remove line on domain for Y axis
    .call(g => g.select('.domain').remove())
    .selectAll('text')
      .attr('fill', '#909090');;

  // color palette = one color per subgroup
  var colorPie = ["#26a7e9", "#a5cd39", "#dd6a6a", "#ffa700", "#00c1b2"];
  var color = d3.scaleOrdinal()
    .domain(subgroups)
    .range(colorPie);
    
  var stackedData = d3.stack().keys(subgroups)(stackedData);

  // Show the bars
  svg.append('g')
    .selectAll('g')
    // Enter in the stack data = loop key per key = group per group
    .data(stackedData)
    .enter().append('g')
    .attr('fill', function(d) { return color(d.key); })
    .selectAll('rect')
    // enter a second time = loop subgroup per subgroup to add all rectangles
    .data(function(d) { return d; })
    .enter()
		.append('rect')
			.attr('id', function(item, _) { return `${item.data.name}`;})
      .attr('x', function(d) { return y(d[0]); })
      .attr('height', x.bandwidth())
      .attr('y', function(d) { return x(d.data.name); })
      .attr('width', function(d) { return y(d[1]) - y(d[0]); })
      .on('click', function(_, d) {
				var idParent = this.id;
        var subgroupName = d3.select(this.parentNode).datum().key;
        var subgroupValue = d.data[subgroupName];
        drillDown(subgroupName + '_' + idParent);
      });
			
	//Add X axis label:
  addText(svg, 'end', 16, 0, (withReduce  / 2) + margin.top, height + margin.left, '#808080', '', axisMiddle + '▼', function () {
    modalCategories(TypeManage.CATEGORIES);
  });
	
	//Y axis label:
  addText(svg, 'end', 16, -90, margin.top + (-height / 2), 0  -margin.bottom + 25, '#808080', axisY, getAxisY(), function () {
    modalCategories(TypeManage.DATA, this.id);
  });

  var withReduce = width - 100;
  var factorBack = margin.top;
  addText(svg, 'start', 16, 0, withReduce + margin.right - 10, 0, '#808080', axisX, getAxisX(), function () {
    modalCategories(TypeManage.DATA, this.id);
  });
  for (var index = 0; index < getCategoriesStack().length; index++) {
		if (indexIgnore.includes(index)) continue;
    var item = getCategoriesStack()[index];

    addText(svg, 'start', 12, 0, withReduce + margin.right + 10, factorBack, '#808080', `id_${index}`, item, function () {
      var id = this.id;
      adminStacked(id, subgroups);
    });

    addCircle(svg, withReduce + margin.right - 5, factorBack - 5, 5, colorPie[indexCircle(index)], `idcircle_${index}`,
    function () {
      return `opacity: ${opacityMarked.includes(index) ? '0.5' : '1'}`;
    },
    function () {
      var id = this.id;
      adminStacked(id, subgroups);
    });

    factorBack += 20;
  }
}

function setStackedColumn() {
  var svg = svgMulti().append('g')
		.attr('transform', `translate(${margin.left + 60}, ${margin.top})`);

  var withReduce = width - 100;
	//region rewrite
  var subgroups = [];
	var stackedData = getStackedData();
  stackedData.map(function(a1) {
    var keys1 = Object.keys(a1);
    keys1.map(function(b1) {
      if (b1 != 'name' && subgroups.indexOf(b1) === -1) {
        subgroups.push(b1);
      }
    });
  });
  //endregion
  var groups = [];
  stackedData.map(function(item) {
    var vGroup = item.name;
    if (groups.indexOf(vGroup) === -1) {
      groups.push(vGroup);
    }
  });
  // Add X axis
  var x = d3.scaleBand()
    .domain(groups)
    .range([0, withReduce])
    .padding(0.2);
  svg.append('g')
    .attr('transform', 'translate(0,' + height + ')')
    .call(
      d3.axisBottom(x)
      .tickSize(7)
      .tickSizeOuter(0)
			.tickFormat(x =>`${getFirst10(x)}`)
    )
    //set color for domain and ticks
    .style("color", '#909090')
    .selectAll('text')
      .attr('transform', d => getCategoriesStack()[0].length > 10 ? `translate(0, 5)rotate(0)` : `translate(-35, 30)rotate(-45)`);

  // Add Y axis
  var y = d3.scaleLinear()
    .domain([0, getStackedMax()])
    .range([ height, 0 ]);
  svg.append('g')
    .call(
      d3.axisLeft(y)
      .tickSize(0))
  //Remove line on domain for Y axis
  .call(g => g.select('.domain').remove())
  //region set lines by each value for y axis
  .call(
	    g => g.selectAll('.tick line')
	    .clone()
	    .attr('stroke-opacity', 0.1)
	    .attr('x2', withReduce))
  .selectAll('text')
    .attr('fill', '#909090');

  // color palette = one color per subgroup
  var colorPie = ["#26a7e9", "#a5cd39", "#dd6a6a", "#ffa700", "#00c1b2"];
  var color = d3.scaleOrdinal()
    .domain(subgroups)
    .range(colorPie);

  var stackedData = d3.stack().keys(subgroups)(stackedData);

  // Show the bars
  svg.append('g')
    .selectAll('g')
    // Enter in the stack data = loop key per key = group per group
    .data(stackedData)
    .enter().append('g')
    .attr('fill', function(d) { return color(d.key); })
    .selectAll('rect')
    // enter a second time = loop subgroup per subgroup to add all rectangles
    .data(function(d) { return d; })
    .enter()
    .append('rect')
    .attr('id', function(item, _) { return `${item.data.name}`;})
    .attr('x', function(d) { return x(d.data.name); })
    .attr('height', function(d) { return y(d[0]) - y(d[1]); })
    .attr('y', function(d) { return y(d[1]); })
    .attr('width', x.bandwidth())
    .on('click', function(_, d) {
      var idParent = this.id;
      var subgroupName = d3.select(this.parentNode).datum().key;
      var subgroupValue = d.data[subgroupName];
      drillDown(subgroupName + '_' + idParent);
    });
		
	//Add X axis label:
  addText(svg, 'end', 14, 0, (width / 2) + margin.top, height + margin.left + 20, '#808080', axisY, getAxisY(), function () {
    modalCategories(TypeManage.DATA, this.id);
  });
	
	//Y axis label:
  addText(svg, 'end', 14, -90, margin.top - (height / 2), 0  -margin.bottom + 4, '#808080', '', `${axisMiddle} ▼`, function () {
    modalCategories(TypeManage.CATEGORIES);
  });

  var withReduce = width - 100;
  var factorBack = margin.top;
  addText(svg, 'start', 16, 0, withReduce + margin.right - 10, 0, '#808080', axisX, getAxisX(), function () {
    modalCategories(TypeManage.DATA, this.id);
  });
  for (var index = 0; index < getCategoriesStack().length; index++) {
		if (indexIgnore.includes(index)) continue;
    var item = getCategoriesStack()[index];

    addText(svg, 'start', 12, 0, withReduce + margin.right + 10, factorBack, '#808080', `id_${index}`, item, function () {
      var id = this.id;
      adminStacked(id, subgroups);
    });

    addCircle(svg, withReduce + margin.right - 5, factorBack - 5, 5, colorPie[indexCircle(index)], `idcircle_${index}`,
    function () {
      return `opacity: ${opacityMarked.includes(index) ? '0.5' : '1'}`;
    },
    function () {
      var id = this.id;
      adminStacked(id, subgroups);
    });

    factorBack += 20;
  }
}

function setBubble() {
  var svg = svgMulti().append('g')
		.attr('transform', `translate(${margin.left + 60}, ${margin.top})`);

  // Add X axis
  var x = d3.scaleBand()
    .domain(aCatHeatX)
    .range([ 0, width ]);
  svg.append('g')
    .attr('transform', 'translate(0,' + height + ')')
    .call(
      d3.axisBottom(x)
      .tickSize(0))
    .call(g => g.select('.domain').remove())
    .selectAll('text')
    .attr('transform', 'translate(0, 10)')
    .attr('fill', '#909090');
  
  var y = d3.scaleBand()
    .range([ height, 0 ])
    .domain(aCatHeatY)
  svg.append("g")
    .call(
      d3.axisLeft(y)
      .tickSize(0)
      .tickFormat(x =>`${getFirst10(x)}`))
    //Remove line on domain for Y axis
    .call(g => g.select('.domain').remove())
    .selectAll('text')
      .attr('fill', '#909090');

  // Add dots
  svg.append('g')
    .selectAll('dot')
    .data(data)
    .enter()
    .append('circle')
    .attr('id', function(item, i){ return `${item.name}_${item.group}`;})
    .attr('cx', function (d) { return x(d.group) + (x.bandwidth() / 2); } )
    .attr('cy', function (d) { return y(d.name) + (y.bandwidth() / 2); } )
    .attr('r', function (d) { return d.value; })
    .style('fill', '#26a7df')
    .style('opacity', '0.65')
    .attr('stroke', '#26a7e9')
    .on('click', function(_) {
      var idParent = this.id;
      drillDown(idParent);
    });
		
	//Add X axis label:
  addText(svg, 'end', 16, 0, (width / 2) + margin.top, height + margin.left, '#808080', '', axisY);
	
	//Y axis label:
  addText(svg, 'end', 16, -90, margin.top + (-height / 2), 0  -margin.bottom + 25, '#808080', '', axisX);
}

function setHeatMap() {
  var svg = svgMulti().append('g')
		.attr('transform', `translate(${margin.left + 60}, ${margin.top})`);

  var x = d3.scaleBand()
    .range([ 0, width ])
    .domain(aCatHeatX)
    .padding(0.01);
  svg.append('g')
    .attr('transform', 'translate(0,' + height + ')')
    .call(
      d3.axisBottom(x)
      .tickSize(0))
    .call(g => g.select('.domain').remove())
    .selectAll('text')
    .attr('transform', 'translate(0, 10)')
    .attr('fill', '#909090');

  var y = d3.scaleBand()
    .range([ height, 0 ])
    .domain(aCatHeatY)
    .padding(0.01);
  svg.append("g")
    .call(
      d3.axisLeft(y)
      .tickSize(0)
      .tickFormat(x =>`${getFirst10(x)}`))
    //Remove line on domain for Y axis
    .call(g => g.select('.domain').remove())
    .selectAll('text')
    .attr('fill', '#909090');
  
  var myColor = d3.scaleLinear()
    .range([backgroundColor, colorBi[0]])
    .domain([0, maxValue]);
  svg
    .selectAll()
    .data(data, function(d) {return d.group+':'+d.name;})
    .enter()
    .append('rect')
    .attr('id', function(item, i){ return `${item.name}_${item.group}`;})
    .attr('x', function(d) { return x(d.group) })
    .attr('y', function(d) { return y(d.name) })
    .attr('width', x.bandwidth() )
    .attr('height', y.bandwidth() )
    .style('fill', function(d) { return myColor(d.value)} )
    .on('click', function(d) {
      var idParent = this.id;
			drillDown(idParent);
    });

  //Add X axis label:
  addText(svg, 'end', 16, 0, (width / 2) + margin.top, height + margin.left, '#808080', '', axisY);
  
  //Y axis label:
  addText(svg, 'end', 16, -90, margin.top + (-height / 2), 0  -margin.bottom + 25, '#808080', '', axisX);
}

function setMultiBar() {
	margin.left = margin.left - 20;
	var svg = d3.select('body').append('svg')
		.attr('width', width + margin.left + margin.right)
		.attr('height', height + margin.top + margin.bottom + 10)
		.append('g')
		.attr('transform', `translate(${margin.left}, ${margin.top})`);
  
  var withReduce = width - 100;
	var keys1 = Object.keys(dataTmp[0]);
  const subgroups = keys1.slice(1);

  // List of groups = species here = value of the first column called group -> I show them on the X axis
  const groups = dataTmp.map(d => d.name);

  // Add X axis
  const x = d3.scaleBand()
    .domain(groups)
    .range([height, 0])
    .padding([0.2]);
  var axis = axisMulti(svg, true, x, 0, 5, splitAxis);
  axis = axis
    //Remove line on domain for X axis
    .call(g => g.select('.domain').remove())
    //region set opacity for each tick item
    .call(g => g.selectAll('.tick line')
      .attr('opacity', 0.2))
  completeAxisMultiple(axis, -10, -25, -45);

    // Add Y axis
  const y = d3.scaleLinear()
    .domain([0, getMaxValue()])
    .range([0, withReduce]);

  axis = axisMulti(svg, false, y, height, 0, formatAxis);
  axis = axis
    //Remove line on domain for X axis
    .call(g => g.select('.domain').remove())
    //region set lines by each value for y axis
    .call(
      g => g.selectAll('.tick line')
      .clone()
      .attr('stroke-opacity', 0.1)
      .attr('y2', -height))
  completeAxisMultiple(axis, 10, 10, -45);

  // Another scale for subgroup position?
  const xSubgroup = d3.scaleBand()
    .domain(subgroups)
    .range([x.bandwidth(), 0])
    .padding([0.05]);

    // color palette = one color per subgroup
  const color = d3.scaleOrdinal()
    .domain(subgroups)
    .range(colorPie);

    // Show the bars
  svg.append('g')
    .selectAll('g')
    // Enter in data = loop group per group
    .data(dataTmp)
    .join('g')
      .attr('transform', d => `translate(0, ${x(d.name)})`)
			.attr('id', function(_,i){ return 'item_' + i;})
    .selectAll('rect')
    .data(function(d) { return subgroups.map(function(key) { return {key: key, value: d[key]}; }); })
    .join('rect')
      .attr('x', d => 0)
      .attr('y', d => xSubgroup(d.key))
      .attr('height', xSubgroup.bandwidth())
      .attr('width', d => y(d.value))
      .attr('fill', d => color(d.key))
      .on('click', function () {
        var idParent = this.parentNode.id
        var aData = idParent.split('_')
        if (aData.length > 0)
        {
          var index = aData[1];
          var mValue = aDrillData[indexData][index];
          var value = `${mValue}_${index}`;
          drillDown(value);
        }
      });
			
	//Add X axis label:
  addText(svg, 'end', 16, 0, (withReduce / 2), height + margin.bottom + 5, '#808080', axisY, getAxisY(), function () {
    modalCategories(TypeManage.SELECTABLE, this.id);
  });

  //Y axis label:
  addText(svg, 'end', 16, -90, margin.top + (-height / 2), -margin.left + 15, '#808080', axisX, getAxisX(), function () {
    modalCategories(TypeManage.PLAIN, this.id);
  });
	
  var factorBack = margin.top;
	var aCategoryTmp = getMultiCategory();
  if (aCategoryTmp.length - indexIgnore.length >= 3)
  {
    addText(svg, 'start', 16, 0, withReduce + margin.right - 10, 0, '#808080', '', 'Category');
    for (var index = 0; index < aCategoryTmp.length; index++)
    {
      if (!indexIgnore.includes(index))
      {
        var item = aCategoryTmp[index];
        addText(svg, 'start', 12, 0, withReduce + margin.right + 10, factorBack, '#808080', `id_${index}`, item, function () {
          var id = this.id;
          adminMulti(id, subgroups);
        });
        addCircle(svg, withReduce + margin.right - 5, factorBack - 5, 5, colorPie[indexCircle(index)], `idcircle_${index}`,
        function () {
          return `opacity: ${opacityMarked.includes(index) ? '0.5' : '1'}`;
        },
        function () {
          var id = this.id;
          adminMulti(id, subgroups);
        });
        factorBack += 20;
      }
    }
  }
}

function setMultiColumn() {
	margin.left = margin.left + 5;
  var svg = svgMulti().append('g')
    .attr('transform', `translate(${margin.left}, ${margin.top})`);

	var withReduce = width - 80;
  var keys1 = Object.keys(dataTmp[0]);
  const subgroups = keys1.slice(1);

  // List of groups = species here = value of the first column called group -> I show them on the X axis
  const groups = dataTmp.map(d => d.name);

  if (getNegativeValue()) {
    console.log('On work');

    var max = Math.max(...aMax);
    var min = Math.max(...aMin);

    var y0 = Math.max(Math.abs(min), Math.abs(max));
    console.log(y0);

    //#region DEFINE Axis Y
    const x = d3.scaleBand()
      .domain(groups)
      .range([0, withReduce])
      .padding([0.2]);
    var axis = axisMulti(svg, false, x, height, 5, splitAxis);
    axis = axis
      //Remove line on domain for X axis
      .call(g => g.select('.domain').remove())
      //region set opacity for each tick item
      .call(g => g.selectAll('.tick line')
        .attr('opacity', 0.2))
      completeAxisMultiple(axis, 10, 10, -45);
      //#endregion
    
    //#region DEFINE Axis Y
    /* This scale produces negative output for negatve input */
    var yScale = d3.scaleLinear()
      .domain([-y0, y0])
      .range([height, 0]);
    
    axis = axisMulti(svg, true, yScale, 0, 0, formatAxis);
	  axis = axis
      //region set lines by each value for y axis
      .call(
        g => g.selectAll('.tick line')
        .clone()
        .attr('stroke-opacity', 0.1)
        .attr('x2', withReduce))
        .call(g => g.select('.domain').remove())
    completeAxisMultiple(axis, 0, 0, 0);
    //#endregion
return
  } else {
    
  }
  

  
}

function setMultiLine() {
  var svg = svgMulti().append('g')
    .attr('transform', `translate(${margin.left}, ${margin.top})`);

  var withReduce = width - 100;
	var keys1 = Object.keys(dataTmp[0]);
  const subgroups = keys1.slice(1);
  
  // Reformat the data: we need an array of arrays of {x, y} tuples
  var dataReady = subgroups.map( function(grpName) { // .map allows to do something for each element of the list
    return {
      name: grpName,
      values: dataTmp.map(function(d) {
        return {subname: d.name, value: +d[grpName]};
      })
    };
  });

  var myColor = d3.scaleOrdinal()
    .domain(subgroups)
    .range(colorPie);

    // Add X axis --> it is a date format
  var x = d3.scaleBand()
    .domain(dataTmp.map(function(d) { return d.name; }))
    .range([0, withReduce])
    .padding(1);

  var axis = axisMulti(svg, false, x, height, 10, splitAxis);
  axis = axis
  //Remove line on domain for X axis
  .call(g => g.select('.domain').remove())
  //region set opacity for each tick item
  .call(
    g => g.selectAll('.tick line')
    .attr('opacity', 0.2))
  completeAxisMultiple(axis, 15, 10, -45);

  // Add Y axis
  var y = d3.scaleLinear()
    .domain([0, getMaxValue()])//maxValue is here
    .range([height, 0]);
  var axis = axisMulti(svg, true, y, 0, 0, formatAxis);
	axis = axis
    .call(
      g => g.selectAll('.tick line')
      .clone()
      .attr('stroke-opacity', 0.1)
      .attr('x2', withReduce)
    )
    //Remove line on domain for Y axis
    .call(g => g.select('.domain').remove())
  completeAxisMultiple(axis, 0, 0, 0);

    // Add the lines
  var line = d3.line()
    .x(function(d) { return x(d.subname) })
    .y(function(d) { return y(d.value) });
  svg.selectAll("myLines")
    .data(dataReady)
    .enter()
    .append("path")
      .attr("d", function(d){ return line(d.values) } )
      .attr("stroke", function(d){ return myColor(d.name) })
      .style("stroke-width", 1)
      .style("fill", "none");
			
	// Add the points
  svg
    // First we need to enter in a group
    .selectAll()
    .data(dataReady)
    .enter()
      .append('g')
      .style("fill", function(d){ return myColor(d.name) })
    // Second we need to enter in the 'values' part of this group
    .selectAll()
    .data(function(d){ return d.values })
    .enter()
    .append("circle")
      .attr('id', function(_, i){ return 'item_' + i;})
      .attr("cx", function(d) { return x(d.subname) } )
      .attr("cy", function(d) { return y(d.value) } )
      .attr("r", 5)
      .attr("stroke", "white")
	    .on('click', function () {
	      var idParent = this.id;
	      var aData = idParent.split('_');
	      if (aData.length > 0)
	      {
          var index = aData[1];
          var mValue = aDrillData[indexData][index];
          var value = `${mValue}_${index}`;
          drillDown(value);
	      }
	    });
		
	//Add X axis label:
  addText(svg, 'end', 16, 0, ((withReduce + margin.right + 10) / 2) + margin.top, height + margin.bottom - 25, '#808080', axisX, getAxisX(), function () {
    modalCategories(TypeManage.PLAIN, this.id);
  });

  //Y axis label:
  addText(svg, 'end', 16, -90, margin.top + (-height / 2), -margin.left + 20, '#808080', axisY, getAxisY(), function () {
    modalCategories(TypeManage.SELECTABLE, this.id);
  });
	
  var factorBack = margin.top;
	var aCategoryTmp = getMultiCategory();
  if (aCategoryTmp.length - indexIgnore.length >= 3)
  {
    addText(svg, 'start', 16, 0, withReduce + margin.right - 10, 0, '#808080', '', 'Category');
    for (var index = 0; index < aCategoryTmp.length; index++)
    {
      if (!indexIgnore.includes(index))
      {
        var item = aCategoryTmp[index];
        addText(svg, 'start', 12, 0, withReduce + margin.right + 10, factorBack, '#808080', `id_${index}`, item, function () {
          var id = this.id;
          adminMulti(id, subgroups);
        });
        addCircle(svg, withReduce + margin.right - 5, factorBack - 5, 5, colorPie[indexCircle(index)], `idcircle_${index}`,
        function () {
          return `opacity: ${opacityMarked.includes(index) ? '0.5' : '1'}`;
        },
        function () {
          var id = this.id;
          adminMulti(id, subgroups);
        });
        factorBack += 20;
      }
    }
  }
}

function setBar() {
	var svg = d3.select('body').append('svg')
		.attr('width', width + margin.left + margin.right)
		.attr('height', height + margin.top + margin.bottom)
		.append('g')
		.attr('transform', 'translate(' + margin.left + ',' + margin.top + ')');

	var x = d3.scaleBand()
		.range([height, 0])
		.padding(0.1);
	var y = d3.scaleLinear()
		.range([0, width]);

	x.domain(data.map(function(d) { return d.name; }));
	y.domain([getMinDomain(), d3.max(data, function(d) { return d.value; })]);

	svg.selectAll()
		.data(data)
		.enter().append('rect')
		.style('fill', function(d) {
			return scaleColorBi(d.value);
		})
		.attr('x', function(d) { return x(d.value); })
		.attr('width', function(d) { return y(d.value); })
		.attr('y', function(d) { return x(d.name); })
		.attr('height', x.bandwidth())
		.on('click', function(_, d) {
			var index = data.indexOf(d);
      var value = drillX[index];
      drillDown(value);
		});

	svg.append('g')
		.attr('transform', 'translate(0,' + height + ')')
		.call(
			d3.axisBottom(y)
			.tickSize(0)
			//format data for each number on Y axis
			.tickFormat(x => `${fformat(x)}`))
		.call(
			g => g.selectAll('.tick line')
			.clone()
			.attr('stroke-opacity', 0.1)
			.attr('y2', -height))
		//Remove line on domain for X axis
		.call(g => g.select('.domain').remove())
		.selectAll('text')
		.attr('transform', 'translate(10,10)rotate(-45)')
		.attr('fill', '#909090');

	svg.append('g')
		.call(
			d3.axisLeft(x)
      .tickFormat(x =>`${getFirst10(x)}`))
		//region set opacity for each tick item
		.call(g => g.selectAll('.tick line')
		.attr('opacity', 0.2))
		//endregion
		//Remove line on domain for Y axis
		.call(g => g.select('.domain').remove())
		.selectAll('text')
		.attr('transform', 'translate(-10,-25)rotate(-45)')
		.attr('fill', '#909090');
	
	  //Add X axis label:
	  addText(svg, 'end', 16, 0, (width / 2) + margin.top, height + margin.top + margin.bottom - 20, '#808080', '', axisY);
	
	  //Y axis label:
	  addText(svg, 'end', 16, -90, margin.top + (-height / 2), -margin.left + 15, '#808080', '', axisX);
	}

function setColumn() {
  var svg = d3.select('body').append('svg')
    .attr('width', width + margin.left + margin.right)
    .attr('height', height + margin.top + margin.bottom)
    .append('g')
    .attr('transform', `translate(${margin.left}, ${margin.top})`);

  var x = d3.scaleBand()
    .range([0, width])
    .padding(0.1);
  var y = d3.scaleLinear()
    .range([height, 0]);

  x.domain(data.map(function(d) { return d.name; }));
  y.domain([getMinDomain(), d3.max(data, function(d) { return d.value; })]);

  svg.selectAll()
    .data(data)
    .enter().append('rect')
    .style('fill', function(d) {
      return scaleColorBi(d.value);
    })
    .attr('x', function(d) { return x(d.name); })
    .attr('width', x.bandwidth())
    .attr('y', function(d) { return y(d.value); })
    .attr('height', function(d) { return height - y(d.value); })
    .on('click', function(_, d) {
      var index = data.indexOf(d);
      var value = drillX[index];
      drillDown(value);
    });

//the X DATA for axis bar
svg.append('g')
  .attr('transform', `translate(0, ${height})`)
  .call(
    d3.axisBottom(x)
    .tickFormat(x =>`${getFirst10(x)}`))
  //Remove line on domain for X axis
  .call(g => g.select('.domain').remove())
  //region set opacity for each tick item
  .call(g => g.selectAll('.tick line')
    .attr('opacity', 0.2))
  //endregion
  .selectAll('text')
  //rotate text
  .attr('transform', 'translate(10,10)rotate(-45)')
  //Set color each item on X axis
  .attr('fill', '#909090')
  .style('text-anchor', 'end');

	//the Y DATA for axis bar
	svg.append('g')
	  //Format numbers on axis
	  .call(
	    d3.axisLeft(y)
	    //remove short line for Y axis
	    .tickSize(0)
	    //format data for each number on Y axis
	    .tickFormat(x => `${fformat(x)}`))
	  //region set lines by each value for y axis
	  .call(
	    g => g.selectAll('.tick line')
	    .clone()
	    .attr('stroke-opacity', 0.1)
	    .attr('x2', width))
	  //endregion
	  //Remove line on domain for Y axis
	  .call(g => g.select('.domain').remove())
	  .selectAll('text')
		.attr('transform', 'translate(0,-8)rotate(-45)')  
	  .attr('fill', '#909090');

	//Add X axis label:
  addText(svg, 'end', 14, 0, (width / 2) + margin.top, height + margin.top + margin.bottom - 25, '#808080', '', axisX);
    
  //Y axis label:
  addText(svg, 'end', 14, -90, margin.top - (height / 2), -margin.left + 15, '#808080', '', axisY);
}

function setLine() {
  var svg = d3.select('body').append('svg')
    .attr('width', width + margin.left + margin.right)
    .attr('height', height + margin.top + margin.bottom)
    .append('g')
    .attr('transform', 'translate(' + margin.left + ',' + margin.top + ')');

    // Initialise a X axis:
    var xScaleBand = d3.scaleBand().range([0, width]).padding(1);

    // Initialize an Y axis
    var yScale = d3.scaleLinear().range([height, 0]);

    // create the X axis
    xScaleBand.domain(data.map(function(d) { return d.name; }));
    // create the Y axis
    yScale.domain([getMinDomain(), d3.max(data, function(d) { return d.value }) ]);

    svg.append("g")
      .attr("transform", "translate(0," + height + ")")
      .call(
        d3.axisBottom(xScaleBand)
        .tickFormat(x =>`${getFirst10(x)}`))
      //Remove line on domain for X axis
      .call(g => g.select('.domain').remove())
			//region set opacity for each tick item
			.call(g => g.selectAll('.tick line')
      .attr('opacity', 0.2))
      .selectAll('text')
      //rotate text
      .attr('transform', 'translate(10,10)rotate(-45)')
      //Set color each item on X axis
      .attr('fill', '#909090')
      .style('text-anchor', 'end');

    svg.append("g")
      .call(
        d3.axisLeft(yScale)
        .tickSize(0)
        .tickFormat(x => `${fformat(x)}`))
      //region set lines by each value for y axis
      .call(
        g => g.selectAll('.tick line')
        .clone()
        .attr('stroke-opacity', 0.1)
        .attr('x2', width)
      )
      //Remove line on domain for Y axis
      .call(g => g.select('.domain').remove())
      .selectAll('text')
			.attr('transform', 'translate(10,10)rotate(-45)')
      .attr('fill', '#909090');

    // Updata the line
    svg.selectAll()
      .data([data], function(d){ return d.value })
      .enter()
      .append("path")
      .attr("d", d3.line()
        .x(function(d) { return xScaleBand(d.name); })
        .y(function(d) { return yScale(d.value); })
        //.curve(d3.curveMonotoneX)
      )
      .attr("stroke", colorBi)
      .attr("stroke-width", 1.5)
      .attr("fill", "none");

    svg.selectAll()
      .data(data)
      .enter()
      .append("circle")
      .attr("cx", function(d) { return xScaleBand(d.name) })
      .attr("cy", function(d) { return yScale(d.value) })
      .attr("r", 5)
      .attr("fill", colorBi)
      .on('click', function(_, d) {
	      var index = data.indexOf(d);
	      var value = drillX[index];
	      drillDown(value);
	    });
			
		//Add X axis label:
    addText(svg, 'end', 16, 0, (width / 2) + margin.top, height + margin.bottom - 5, '#808080', '', axisX);
    //Y axis label:
    addText(svg, 'end', 16, -90, margin.top + (-height / 2), -margin.left + 20, '#808080', '', axisY);
	}
	
function setDonut() {
  var arc = d3.arc()
    .outerRadius(radius)
		.innerRadius(radius * 0.5);

	var pie = d3.pie()
		.sort(null)
		.value(function(d) {
			return d.value;
		});
		
	var maxWidth = width + margin.left + margin.right;
  var maxHeight = height + margin.top + margin.bottom;

	var svg = d3.select('body').append('svg')
    .attr('width', maxWidth)
    .attr('height', maxHeight)
		.append('g')
		.attr('transform', 'translate(' + maxWidth * 0.65 + ',' + maxHeight * 0.65 + ')');

	var g = svg.selectAll('.arc')
		.data(pie(dataTmp))
		.enter().append('g');

	g.append('path')
		.attr('d', arc)
		.style('fill', function(_, i) {
			return colorPie[i];
		})
		.on('click', function(_, i) {
			var index = i.index;
			var value = drillX[index];
			drillDown(value);
		});
		
	var factorBack = -(maxHeight / 2) - 30;
		
  for (const index in dataFormatted) {
    var item = dataFormatted[index];
    addText(svg, 'start', 12, 0, -(maxWidth / 2) - 20, factorBack, '#808080', `id_${index}`, item.name + ': ' + item.value, function () {
      var id = this.id;
      adminOpacity(id);
    });
		
    addCircle(svg, -(maxWidth / 2) - 30, factorBack - 5, 5, colorPie[index], `idcircle_${index}`,
      function () {
        return `opacity: ${opacityMarked.includes(index) ? '0.5' : '1'}`;
      },
      function () {
        var id = this.id;
        adminOpacity(id);
    });
    factorBack += 20;
  }
}


$('#idTableBasic tfoot th').each(function () {
    var indexInput = $(this).index();
    var title = $(this).text();
    var idInput = title.replace(/\s/g, '_').replace('(', '_').replace(')', '_').replace('&', '_').replace('/', '_') + '_Basic';
	$(this).html(
        '<input id=' + idInput +
        ' type="text" placeholder="filter column..."/>');

    $("#" + idInput).on('input', function () {
        var filter = $(this).val().toUpperCase();
        var table = document.getElementById("idTableBasic");
        var tr = table.getElementsByTagName("tr");

        for (index = 0; index < tr.length; index++) {
            td = tr[index].getElementsByTagName("td")[indexInput];
            if (td) {
                txtValue = td.textContent || td.innerText;
                if (txtValue.toUpperCase().indexOf(filter) > -1) {
                    tr[index].style.display = "";
                } else {
                    tr[index].style.display = "none";
                }
            }
        }
    });
});

$('#idTableDataPivot tfoot th').each(function () {
    var indexInput = $(this).index();
    var title = $(this).text();
    var idInput = title.replace(/\s/g, '_').replace('(', '_').replace(')', '_').replace('&', '_').replace('/', '_') + '_DataPivot';
	$(this).html(
        '<input id=' + idInput +
        ' type="text" placeholder="Search on ' + title + '"/>');

    $("#" + idInput).on('input', function () {
        var filter = $(this).val().toUpperCase();
        var table = document.getElementById("idTableDataPivot");
        var tr = table.getElementsByTagName("tr");

        for (index = 0; index < tr.length; index++) {
            td = tr[index].getElementsByTagName("td")[indexInput];
            if (td) {
                txtValue = td.textContent || td.innerText;
                if (txtValue.toUpperCase().indexOf(filter) > -1) {
                    tr[index].style.display = "";
                } else {
                    tr[index].style.display = "none";
                }
            }
        }
    });
});

function showFilter() {
	var display = $('tfoot').is(':visible') ? 'none' : 'table-header-group';
  $('tfoot').css({'display': display});
}

function adminMulti(id, subgroups) {
  var words = id.split('_');
  var index = parseInt(words[1]);
  var subGroup = subgroups[index];
  var exist = opacityMarked.includes(index);
  if (exist) {
    var tmp = -1;
    for (let _index = 0; _index < opacityMarked.length; _index++) {
      if (index == opacityMarked[_index])
      {
        tmp = _index;
        break;
      }
    }
    opacityMarked.splice(tmp, 1);
  }
  else opacityMarked.push(index);

  var aTmp = getDataMulti();
	for (position in dataTmp) {
    var element = aTmp[position];
		var itEdit = dataTmp[position];
  
		itEdit[subGroup] = exist ? element[subGroup] : 0;
  }
  isAgain = true;
  updateData(typeChart, true);
}

function callAdminStacked(aIndex, subgroups) {
	indexIgnore = aIndex;
  if (aIndex.length > 0) {
    for (let index = 0; index < aIndex.length; index++) {
      const element = aIndex[index];
      controlStacked(element, subgroups);
    }
  } else {
    for (let index1 = 0; index1 < opacityMarked.length; index1++) {
      const element = opacityMarked[index1];
      controlStacked(element, subgroups);
    }
  }
  isAgain = true;
  updateData(typeChart, true);
}

function adminStacked(id, subgroups) {
  var words = id.split('_');
  controlStacked(words[1], subgroups);
  isAgain = true;
  updateData(typeChart, true);
}

function controlStacked(id, subgroups) {
  var index = parseInt(id);
  var exist = opacityMarked.includes(index);
  if (exist) {
    var tmp = -1;
    for (let _index = 0; _index < opacityMarked.length; _index++) {
      if (index == opacityMarked[_index])
      {
        tmp = _index;
        break;
      }
    }
    opacityMarked.splice(tmp, 1);
  }
  else {
    opacityMarked.push(index);
  }
  //#endregion
  //#region set value original or zero
  var sub = getCategoriesStack()[index];
  for (var index1 = 0; index1 < aStacked.length; index1++) {
    var element = aStackedTmp[index1];
    var edit = aStacked[index1];
    edit[sub] = exist ? element[sub] : 0;
  }
  //#endregion
	updateSelected(`${index}_${exist}`);
}

function adminOpacity(id) {
  var words = id.split('_');
  var index = words[1];

  var exist = opacityMarked.includes(index);
  if (exist)
  {
    var tmp = -1;
    for (let _index = 0; _index < opacityMarked.length; _index++) {
      if (index == opacityMarked[_index])
      {
        tmp = _index;
        break;
      }
    }
    var item = getDataOrMulti()[index];
    dataTmp[index].value = item.value;
    opacityMarked.splice(tmp, 1);
  }
  else 
  {
    dataTmp[index].value = 0;
    opacityMarked.push(index);
  }
  isAgain = true;
  updateData(typeChart, true);
}

function getMaxValue()
{
	if (aMaxData.length !== 0)
  {
    var aTotalIndices = [];
    var key = `${indexData}_${isCurrency ? 1 : 2}`;
    var aTmp = aMaxData.length !== 0 ? aMaxData[key] : [];
    var aTmp = aMaxData[key];
    for (index = 0; index < aTmp.length; index++)
    {
      if (indexIgnore.includes(index)) continue;
      var value = aTmp[index];
      aTotalIndices.push(value);
    }
    var maxMath = Math.max.apply(null, aTotalIndices);
    return maxMath !== 0 ? maxMath : 1;
  }
  else
  {
    return maxValue;
  }
}

function getMinDomain() {
  var minDomain = 0;
  if (minValue2 === -1) {
    var values = [];
    for (let index = 0; index < data.length; index++) {
      const item = data[index];
      values.push(item.value);
    }
    var minimum = Math.min.apply(Math, values);
    var residue = minimum % 10000;
    minimum =  minimum - residue;
    if (minimum > 0) {
      minDomain = minimum;
    }
  }
  return minDomain;
}

function getMinValue()
{
  return isCurrency ? minValue : minValue2;
}

function getDataOrMulti()
{
	return data.length !== 0 ? data : getDataMulti();
}

function getDataMulti()
{
	if (aAllData.length !== 0)
	{
    var key = `${indexData}_${isCurrency ? 1 : 2}`;
    return aAllData[key];
	}
	else return [];
}

function getNegativeValue() {
  if (Object.keys(hasNegative).length === 0) {
    return false;
  } else {
    return hasNegative[`${indexData}_${isCurrency ? 1 : 2}`];
  }
}

function getStackedMax()
{
  var sumTop = 0;
  var aStacked = getStackedData();
  var aCat = getCategoriesStack();
  for (var index1 = 0; index1 < aStacked.length; index1++)
  {
    var sum = 0;
    const iStacked = aStacked[index1];
    for (var index2 = 0; index2 < aCat.length; index2++)
    {
      const iCat = aCat[index2];
      sum += iStacked[iCat];
    }
    if (sumTop < sum) sumTop = sum;
  }
  return sumTop;
}

function setOtherStacked()
{
  isCurrency = !isCurrency;
  var tmp = axisX;
  axisX = axisY;
  axisY = tmp;
  isAgain = true;
  updateData(typeChart, true);
}

function getCategoriesStack()
{
  return isCurrency ? aCatHeatY : aCatHeatX;
}

function getStackedData()
{
  return isCurrency ? aStacked : aStacked2;
}

function getMultiCategory()
{
  return isCurrency ? aCategory : aCategory2;
}

function indexCircle(index)
{
  return index % colorPie.length;
}

$('td').click(function() {
  var $this = $(this);
  var row = $this.closest('tr').index();
  var column = $this.closest('td').index();
  var firstColumn = $this.closest('tr');
  var finalText = firstColumn[0].firstChild.innerText;
  var strDate = firstColumn[0].children[1].innerText;
  var index = aCategoryX.indexOf(finalText);
	if (nColumns == 3) {
    switch (typeChart) {
      case TypeEnum.TABLE:
        var secondCell = firstColumn[0].children[1].innerText;
        finalText += `_${secondCell}`;
        break;
      case TypeEnum.PIVOT:
        if (column == 0) return;
        var secondCell = aCategoryX[column - 1];
        finalText = `${secondCell}_${finalText}`;
        break;  
      default:
        break;
    }
	}
  else
    finalText = drillX[index];
  drillDown(finalText);
});
var scaleColorBi = d3.scaleOrdinal().range(colorBi);

//region locale settings
var locale = d3.formatLocale({
  "decimal": ",",//","
  "thousands": ",",//" ",
  "grouping": [3],
  "currency": ["$", ""]//["€", ""] first if prefix, second is suffix
});
var fformat = locale.format("$,");
//endregion

$(window).resize(function() {
  updateData(typeChart, true);
});
updateData(typeChart);
</script>
</body>
</html>